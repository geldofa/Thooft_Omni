import{c as Ke,j as e,r as x,W as Rr,ac as rr,ad as Dr,V as Er,ae as Gr,U as tr,af as Mr,X as Ar,Y as ee,ag as sr,ah as Lr,ai as Ir,aj as Br,ak as Vr,al as Jr,$ as Kr,D as ar,a as nr,b as lr,d as cr,e as or,L as T,P as Hr,f as Wr,B as O,C as $r,g as zr,h as Ur,I as v,i as ir,t as Re,z as qr,A as Yr,E as De,F as Ee,am as be,an as je,ao as Ne,ap as Qr,aq as ve,T as Ge,J as qe,M as Ye,N as Qe,O as Xe,Q as q,H as Xr,ar as Ze}from"./index-BLdvJl3a.js";import{T as Me,a as Ae,b as $,c as f,d as Le,e as g}from"./table-BiTOq6bB.js";import{B as Ie}from"./badge-DgA3EjQI.js";import{C as ce}from"./checkbox-CjRRcBPz.js";import{T as Zr}from"./textarea-Dfz72lz7.js";import{P as ye,S as er}from"./square-pen-DI-qAxEv.js";import{S as et}from"./search-BO0duIt8.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rt=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],tt=Ke("arrow-down",rt);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const st=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],at=Ke("arrow-up",st);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nt=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],lt=Ke("calculator",nt),M=(s,a=0)=>{if(s==null||s==="")return"";const n=typeof s=="string"?parseFloat(s):s;return isNaN(n)?"":n.toLocaleString("nl-NL",{minimumFractionDigits:a,maximumFractionDigits:a,useGrouping:!0})};var ct=Symbol("radix.slottable");function ot(s){const a=({children:n})=>e.jsx(e.Fragment,{children:n});return a.displayName=`${s}.Slottable`,a.__radixId=ct,a}var[_e]=Rr("Tooltip",[rr]),Ce=rr(),dr="TooltipProvider",it=700,Ve="tooltip.open",[dt,He]=_e(dr),mr=s=>{const{__scopeTooltip:a,delayDuration:n=it,skipDelayDuration:i=300,disableHoverableContent:h=!1,children:o}=s,p=x.useRef(!0),S=x.useRef(!1),N=x.useRef(0);return x.useEffect(()=>{const C=N.current;return()=>window.clearTimeout(C)},[]),e.jsx(dt,{scope:a,isOpenDelayedRef:p,delayDuration:n,onOpen:x.useCallback(()=>{window.clearTimeout(N.current),p.current=!1},[]),onClose:x.useCallback(()=>{window.clearTimeout(N.current),N.current=window.setTimeout(()=>p.current=!0,i)},[i]),isPointerInTransitRef:S,onPointerInTransitChange:x.useCallback(C=>{S.current=C},[]),disableHoverableContent:h,children:o})};mr.displayName=dr;var oe="Tooltip",[mt,ie]=_e(oe),xr=s=>{const{__scopeTooltip:a,children:n,open:i,defaultOpen:h,onOpenChange:o,disableHoverableContent:p,delayDuration:S}=s,N=He(oe,s.__scopeTooltip),C=Ce(a),[d,w]=x.useState(null),R=Dr(),D=x.useRef(0),A=p??N.disableHoverableContent,B=S??N.delayDuration,k=x.useRef(!1),[J,P]=Er({prop:i,defaultProp:h??!1,onChange:X=>{X?(N.onOpen(),document.dispatchEvent(new CustomEvent(Ve))):N.onClose(),o?.(X)},caller:oe}),H=x.useMemo(()=>J?k.current?"delayed-open":"instant-open":"closed",[J]),m=x.useCallback(()=>{window.clearTimeout(D.current),D.current=0,k.current=!1,P(!0)},[P]),V=x.useCallback(()=>{window.clearTimeout(D.current),D.current=0,P(!1)},[P]),de=x.useCallback(()=>{window.clearTimeout(D.current),D.current=window.setTimeout(()=>{k.current=!0,P(!0),D.current=0},B)},[B,P]);return x.useEffect(()=>()=>{D.current&&(window.clearTimeout(D.current),D.current=0)},[]),e.jsx(Gr,{...C,children:e.jsx(mt,{scope:a,contentId:R,open:J,stateAttribute:H,trigger:d,onTriggerChange:w,onTriggerEnter:x.useCallback(()=>{N.isOpenDelayedRef.current?de():m()},[N.isOpenDelayedRef,de,m]),onTriggerLeave:x.useCallback(()=>{A?V():(window.clearTimeout(D.current),D.current=0)},[V,A]),onOpen:m,onClose:V,disableHoverableContent:A,children:n})})};xr.displayName=oe;var Je="TooltipTrigger",ur=x.forwardRef((s,a)=>{const{__scopeTooltip:n,...i}=s,h=ie(Je,n),o=He(Je,n),p=Ce(n),S=x.useRef(null),N=tr(a,S,h.onTriggerChange),C=x.useRef(!1),d=x.useRef(!1),w=x.useCallback(()=>C.current=!1,[]);return x.useEffect(()=>()=>document.removeEventListener("pointerup",w),[w]),e.jsx(Mr,{asChild:!0,...p,children:e.jsx(Ar.button,{"aria-describedby":h.open?h.contentId:void 0,"data-state":h.stateAttribute,...i,ref:N,onPointerMove:ee(s.onPointerMove,R=>{R.pointerType!=="touch"&&!d.current&&!o.isPointerInTransitRef.current&&(h.onTriggerEnter(),d.current=!0)}),onPointerLeave:ee(s.onPointerLeave,()=>{h.onTriggerLeave(),d.current=!1}),onPointerDown:ee(s.onPointerDown,()=>{h.open&&h.onClose(),C.current=!0,document.addEventListener("pointerup",w,{once:!0})}),onFocus:ee(s.onFocus,()=>{C.current||h.onOpen()}),onBlur:ee(s.onBlur,h.onClose),onClick:ee(s.onClick,h.onClose)})})});ur.displayName=Je;var We="TooltipPortal",[xt,ut]=_e(We,{forceMount:void 0}),hr=s=>{const{__scopeTooltip:a,forceMount:n,children:i,container:h}=s,o=ie(We,a);return e.jsx(xt,{scope:a,forceMount:n,children:e.jsx(sr,{present:n||o.open,children:e.jsx(Lr,{asChild:!0,container:h,children:i})})})};hr.displayName=We;var re="TooltipContent",pr=x.forwardRef((s,a)=>{const n=ut(re,s.__scopeTooltip),{forceMount:i=n.forceMount,side:h="top",...o}=s,p=ie(re,s.__scopeTooltip);return e.jsx(sr,{present:i||p.open,children:p.disableHoverableContent?e.jsx(gr,{side:h,...o,ref:a}):e.jsx(ht,{side:h,...o,ref:a})})}),ht=x.forwardRef((s,a)=>{const n=ie(re,s.__scopeTooltip),i=He(re,s.__scopeTooltip),h=x.useRef(null),o=tr(a,h),[p,S]=x.useState(null),{trigger:N,onClose:C}=n,d=h.current,{onPointerInTransitChange:w}=i,R=x.useCallback(()=>{S(null),w(!1)},[w]),D=x.useCallback((A,B)=>{const k=A.currentTarget,J={x:A.clientX,y:A.clientY},P=bt(J,k.getBoundingClientRect()),H=jt(J,P),m=Nt(B.getBoundingClientRect()),V=yt([...H,...m]);S(V),w(!0)},[w]);return x.useEffect(()=>()=>R(),[R]),x.useEffect(()=>{if(N&&d){const A=k=>D(k,d),B=k=>D(k,N);return N.addEventListener("pointerleave",A),d.addEventListener("pointerleave",B),()=>{N.removeEventListener("pointerleave",A),d.removeEventListener("pointerleave",B)}}},[N,d,D,R]),x.useEffect(()=>{if(p){const A=B=>{const k=B.target,J={x:B.clientX,y:B.clientY},P=N?.contains(k)||d?.contains(k),H=!vt(J,p);P?R():H&&(R(),C())};return document.addEventListener("pointermove",A),()=>document.removeEventListener("pointermove",A)}},[N,d,p,C,R]),e.jsx(gr,{...s,ref:o})}),[pt,gt]=_e(oe,{isInside:!1}),ft=ot("TooltipContent"),gr=x.forwardRef((s,a)=>{const{__scopeTooltip:n,children:i,"aria-label":h,onEscapeKeyDown:o,onPointerDownOutside:p,...S}=s,N=ie(re,n),C=Ce(n),{onClose:d}=N;return x.useEffect(()=>(document.addEventListener(Ve,d),()=>document.removeEventListener(Ve,d)),[d]),x.useEffect(()=>{if(N.trigger){const w=R=>{R.target?.contains(N.trigger)&&d()};return window.addEventListener("scroll",w,{capture:!0}),()=>window.removeEventListener("scroll",w,{capture:!0})}},[N.trigger,d]),e.jsx(Br,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:p,onFocusOutside:w=>w.preventDefault(),onDismiss:d,children:e.jsxs(Vr,{"data-state":N.stateAttribute,...C,...S,ref:a,style:{...S.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(ft,{children:i}),e.jsx(pt,{scope:n,isInside:!0,children:e.jsx(Jr,{id:N.contentId,role:"tooltip",children:h||i})})]})})});pr.displayName=re;var fr="TooltipArrow",br=x.forwardRef((s,a)=>{const{__scopeTooltip:n,...i}=s,h=Ce(n);return gt(fr,n).isInside?null:e.jsx(Ir,{...h,...i,ref:a})});br.displayName=fr;function bt(s,a){const n=Math.abs(a.top-s.y),i=Math.abs(a.bottom-s.y),h=Math.abs(a.right-s.x),o=Math.abs(a.left-s.x);switch(Math.min(n,i,h,o)){case o:return"left";case h:return"right";case n:return"top";case i:return"bottom";default:throw new Error("unreachable")}}function jt(s,a,n=5){const i=[];switch(a){case"top":i.push({x:s.x-n,y:s.y+n},{x:s.x+n,y:s.y+n});break;case"bottom":i.push({x:s.x-n,y:s.y-n},{x:s.x+n,y:s.y-n});break;case"left":i.push({x:s.x+n,y:s.y-n},{x:s.x+n,y:s.y+n});break;case"right":i.push({x:s.x-n,y:s.y-n},{x:s.x-n,y:s.y+n});break}return i}function Nt(s){const{top:a,right:n,bottom:i,left:h}=s;return[{x:h,y:a},{x:n,y:a},{x:n,y:i},{x:h,y:i}]}function vt(s,a){const{x:n,y:i}=s;let h=!1;for(let o=0,p=a.length-1;o<a.length;p=o++){const S=a[o],N=a[p],C=S.x,d=S.y,w=N.x,R=N.y;d>i!=R>i&&n<(w-C)*(i-d)/(R-d)+C&&(h=!h)}return h}function yt(s){const a=s.slice();return a.sort((n,i)=>n.x<i.x?-1:n.x>i.x?1:n.y<i.y?-1:n.y>i.y?1:0),_t(a)}function _t(s){if(s.length<=1)return s.slice();const a=[];for(let i=0;i<s.length;i++){const h=s[i];for(;a.length>=2;){const o=a[a.length-1],p=a[a.length-2];if((o.x-p.x)*(h.y-p.y)>=(o.y-p.y)*(h.x-p.x))a.pop();else break}a.push(h)}a.pop();const n=[];for(let i=s.length-1;i>=0;i--){const h=s[i];for(;n.length>=2;){const o=n[n.length-1],p=n[n.length-2];if((o.x-p.x)*(h.y-p.y)>=(o.y-p.y)*(h.x-p.x))n.pop();else break}n.push(h)}return n.pop(),a.length===1&&n.length===1&&a[0].x===n[0].x&&a[0].y===n[0].y?a:a.concat(n)}var Ct=mr,wt=xr,kt=ur,Tt=hr,Ft=pr,St=br;function Ot({delayDuration:s=0,...a}){return e.jsx(Ct,{"data-slot":"tooltip-provider",delayDuration:s,...a})}function Pt({...s}){return e.jsx(Ot,{children:e.jsx(wt,{"data-slot":"tooltip",...s})})}function Rt({...s}){return e.jsx(kt,{"data-slot":"tooltip-trigger",...s})}function Dt({className:s,sideOffset:a=0,children:n,...i}){return e.jsx(Tt,{children:e.jsxs(Ft,{"data-slot":"tooltip-content",sideOffset:a,className:Kr("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",s),...i,children:[n,e.jsx(St,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}const Be=({value:s,onChange:a,className:n})=>{const[i,h]=x.useState(()=>s!==null?new Intl.NumberFormat("nl-NL").format(Number(s)):""),[o,p]=x.useState(!1);x.useEffect(()=>{o||h(s!==null?new Intl.NumberFormat("nl-NL").format(Number(s)):"")},[s,o]);const S=()=>{p(!0),h(String(s??""))},N=()=>{p(!1)},C=d=>{const w=d.target.value.replace(/\./g,"").replace(/[^\d]/g,"");h(d.target.value);const R=parseInt(w,10);a(isNaN(R)?null:R)};return e.jsx(v,{value:i,onChange:C,onFocus:S,onBlur:N,className:n,inputMode:"numeric"})};function Et({open:s,onOpenChange:a,onSubmit:n,editJob:i}){const h={date:new Date().toISOString().split("T")[0],datum:"",orderNr:"",orderName:"",version:"",opmerkingen:"",pages:null,exOmw:"",netRun:null,startup:!1,c4_4:null,c4_0:null,c1_0:null,c1_1:null,c4_1:null,maxGross:0,green:null,red:null,delta:0,delta_number:0,delta_percentage:0,performance:""},[o,p]=x.useState(h);x.useEffect(()=>{if(s)if(i){const{id:d,...w}=i;p(w)}else p(h)},[i,s]);const S=d=>{if(d.preventDefault(),!o.orderNr.trim()||!o.orderName.trim()){Re.error("Please fill out Order Nr and Order Name");return}n(o),a(!1),i?Re.success("Job updated successfully"):Re.success("Job added successfully")},N=d=>d?new Date(d).toLocaleDateString("nl-BE",{year:"numeric",month:"short",day:"numeric"}):"Pick a date",C=d=>w=>{p({...o,[d]:w.target.value===""?null:Number(w.target.value)})};return e.jsx(ar,{open:s,onOpenChange:a,children:e.jsxs(nr,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(lr,{children:[e.jsx(cr,{children:i?"Edit Finished Job":"Add Finished Job"}),e.jsx(or,{children:i?"Update the job details below.":"Fill in the details for the new finished job."})]}),e.jsxs("form",{onSubmit:S,children:[e.jsxs("div",{className:"grid gap-2 py-2",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"date",className:"text-right text-xs",children:"Date"}),e.jsxs(Hr,{children:[e.jsx(Wr,{asChild:!0,children:e.jsxs(O,{variant:"outline",className:"col-span-3 justify-start text-left text-xs h-8",children:[e.jsx($r,{className:"mr-2 h-4 w-4"}),N(o.date)]})}),e.jsx(zr,{className:"w-auto p-0",align:"start",children:e.jsx(Ur,{mode:"single",selected:new Date(o.date),onSelect:d=>p({...o,date:d?.toISOString().split("T")[0]||""}),initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"orderNr",className:"text-right text-xs",children:"Order Nr."}),e.jsx(v,{id:"orderNr",value:o.orderNr,onChange:d=>p({...o,orderNr:d.target.value}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"orderName",className:"text-right text-xs",children:"Order"}),e.jsx(v,{id:"orderName",value:o.orderName,onChange:d=>p({...o,orderName:d.target.value}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"version",className:"text-right text-xs",children:"Version/Katern"}),e.jsx(v,{id:"version",value:o.version,onChange:d=>p({...o,version:d.target.value}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"opmerkingen",className:"text-right text-xs",children:"Opmerkingen"}),e.jsx(Zr,{id:"opmerkingen",value:o.opmerkingen,onChange:d=>p({...o,opmerkingen:d.target.value}),className:"col-span-3 text-xs"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"pages",className:"text-right text-xs",children:"Pages"}),e.jsx(v,{id:"pages",type:"number",value:o.pages??"",onChange:C("pages"),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"exOmw",className:"text-right text-xs",children:"Ex/Omw."}),e.jsx(v,{id:"exOmw",value:o.exOmw,onChange:d=>p({...o,exOmw:d.target.value}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"netRun",className:"text-right text-xs",children:"Oplage Netto"}),e.jsx(Be,{value:o.netRun,onChange:d=>p({...o,netRun:d}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"startup",className:"text-right text-xs",children:"Opstart"}),e.jsx("div",{className:"col-span-3 flex items-center",children:e.jsx(ce,{id:"startup",checked:o.startup,onCheckedChange:d=>p({...o,startup:!!d})})})]}),e.jsx("h3",{className:"font-semibold col-span-4 pt-2 text-sm",children:"Wissels"}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"c4_4",className:"text-right text-xs",children:"4/4"}),e.jsx(v,{id:"c4_4",type:"number",value:o.c4_4??"",onChange:C("c4_4"),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"c4_0",className:"text-right text-xs",children:"4/0"}),e.jsx(v,{id:"c4_0",type:"number",value:o.c4_0??"",onChange:C("c4_0"),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"c1_0",className:"text-right text-xs",children:"1/0"}),e.jsx(v,{id:"c1_0",type:"number",value:o.c1_0??"",onChange:C("c1_0"),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"c1_1",className:"text-right text-xs",children:"1/1"}),e.jsx(v,{id:"c1_1",type:"number",value:o.c1_1??"",onChange:C("c1_1"),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"c4_1",className:"text-right text-xs",children:"4/1"}),e.jsx(v,{id:"c4_1",type:"number",value:o.c4_1??"",onChange:C("c4_1"),className:"col-span-3 text-xs h-8"})]}),e.jsx("h3",{className:"font-semibold col-span-4 pt-2 text-sm",children:"Resultaten"}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"green",className:"text-right text-xs",children:"Groen"}),e.jsx(Be,{value:o.green,onChange:d=>p({...o,green:d}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(T,{htmlFor:"red",className:"text-right text-xs",children:"Rood"}),e.jsx(Be,{value:o.red,onChange:d=>p({...o,red:d}),className:"col-span-3 text-xs h-8"})]})]}),e.jsxs(ir,{children:[e.jsx(O,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(O,{type:"submit",children:i?"Update Job":"Add Job"})]})]})]})})}function Kt({presses:s}){const a=s.filter(r=>r.active&&!r.archived).map(r=>r.name),[n,i]=x.useState(()=>localStorage.getItem("drukwerkenActiveTab")||"werkorders");x.useEffect(()=>{localStorage.setItem("drukwerkenActiveTab",n)},[n]);const[h,o]=x.useState(!1),[p,S]=x.useState(null),N={orderNr:"",orderName:"New Werkorder",orderDate:new Date().toISOString().split("T")[0]},C={version:"",pages:null,exOmw:"",netRun:0,startup:!1,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:null,red:null,delta:0,deltaPercentage:0},[d,w]=x.useState([{id:"1",orderNr:"0001",orderName:"Spar 2025-01",orderDate:"2025-01-01",katernen:[{id:"1-1",version:"Nederlands - Katern 1",pages:40,exOmw:"2",netRun:1e5,startup:!0,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:101e3,red:3e3,delta:0,deltaPercentage:0},{id:"1-2",version:"Frans - Katern 1",pages:40,exOmw:"2",netRun:5e4,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:50500,red:1500,delta:0,deltaPercentage:0}]}]),R=r=>{D(C,r)},D=(r,t)=>{w(d.map(l=>{if(l.id===t){const u={...r,id:`${l.id}-${l.katernen.length+1}`};return{...l,katernen:[...l.katernen,u]}}return l}))},A={id:"new-katern-1",version:"",pages:null,exOmw:"",netRun:0,startup:!1,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:null,red:null,delta:0,deltaPercentage:0},B=r=>{const t=Date.now().toString(),l={...A,id:`${t}-1`},u={...r,id:t,katernen:[l]};w([u,...d])},k=(r,t,l,u)=>{w(y=>y.map(b=>b.id===r?{...b,katernen:b.katernen.map(c=>{if(c.id===t){if(["pages","netRun","c4_4","c4_0","c1_0","c1_1","c4_1","green","red"].includes(l)){const E=u===""?null:Number(u);return{...c,[l]:E}}return l==="startup"?{...c,[l]:!!u}:{...c,[l]:u}}return c})}:b))},J=r=>{const t=r.katernen.map(l=>{const u=new Date,y=Ze(u,"yyyy-MM-dd"),b=Ze(u,"dd-MM"),c={...l,orderNr:r.orderNr,orderName:r.orderName,date:y,datum:b},E=m("maxGross")?typeof j(m("maxGross").formula,c)=="number"?j(m("maxGross").formula,c):Number(String(j(m("maxGross").formula,c)).replace(/\./g,"").replace(",",".")):l.maxGross,_=Number(E)||0,G={...c,maxGross:_},F=m("green")?typeof j(m("green").formula,G)=="number"?j(m("green").formula,G):Number(String(j(m("green").formula,G)).replace(/\./g,"").replace(",",".")):l.green,K=m("red")?typeof j(m("red").formula,G)=="number"?j(m("red").formula,G):Number(String(j(m("red").formula,G)).replace(/\./g,"").replace(",",".")):l.red,W=m("delta_number")?typeof j(m("delta_number").formula,G)=="number"?j(m("delta_number").formula,G):Number(String(j(m("delta_number").formula,G)).replace(/\./g,"").replace(",",".")):l.delta,Pe=m("delta_percentage")?(()=>{const le=m("delta_percentage");return le.formula&&le.formula.trim()!=="(green + red) / maxGross"?typeof j(le.formula,G)=="number"?j(le.formula,G):Number(String(j(le.formula,G)).replace(/\./g,"").replace(",",".")):_!==0?(Number(F)+Number(K))/_*100:0})():l.deltaPercentage;return{id:Date.now().toString()+"-"+l.id,date:y,datum:b,orderNr:r.orderNr,orderName:r.orderName,version:l.version,pages:l.pages,exOmw:l.exOmw,netRun:l.netRun,startup:l.startup,c4_4:l.c4_4,c4_0:l.c4_0,c1_0:l.c1_0,c1_1:l.c1_1,c4_1:l.c4_1,maxGross:_,green:Number(F)||0,red:Number(K)||0,delta_number:Number(W)||0,delta_percentage:Number(Pe)||0,delta:Number(W)||0,performance:"100%"}});me(l=>[...t,...l])},[P,H]=x.useState(()=>{const r={};return a.forEach(t=>{r[t]={marge:0,margePercentage:"4,2",opstart:6e3,param_4_4:4e3,param_4_0:3e3,param_1_0:1500,param_1_1:2e3,param_4_1:3500}}),r}),m=r=>Z.find(t=>t.targetColumn===r),[V,de]=x.useState({marge:!1,margePercentage:!1,opstart:!1,param_4_4:!1,param_4_0:!1,param_1_0:!1,param_1_1:!1,param_4_1:!1}),X=(r,t,l)=>{if(V[t]){const u={...P};a.forEach(y=>{u[y]={...u[y],[t]:l}}),H(u)}else H({...P,[r]:{...P[r],[t]:l}})},we=r=>{const t=!V[r];if(de({...V,[r]:t}),t&&a.length>0){const l=P[a[0]][r],u={...P};a.forEach(y=>{u[y]={...u[y],[r]:l}}),H(u)}},[Y,me]=x.useState([{id:"1",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Nederlands - Katern 1",pages:40,exOmw:"2",netRun:1e5,startup:!0,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:101e3,red:3e3,delta_number:0,delta_percentage:0,delta:0,performance:"100%"},{id:"2",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Frans - Katern 1",pages:40,exOmw:"2",netRun:5e4,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:50500,red:1500,delta_number:0,delta_percentage:0,delta:0,performance:"100%"},{id:"3",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Nederlands - Katern 2",pages:32,exOmw:"2",netRun:1e5,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:101e3,red:3e3,delta_number:0,delta_percentage:0,delta:0,performance:"100%"},{id:"4",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Frans - Katern 2",pages:32,exOmw:"2",netRun:5e4,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:50500,red:1500,delta_number:0,delta_percentage:0,delta:0,performance:"100%"}]),[z,jr]=x.useState(null),[ke,Nr]=x.useState(""),[Te,vr]=x.useState("all"),L=r=>{jr(t=>t?.key===r?t.direction==="asc"?{key:r,direction:"desc"}:null:{key:r,direction:"asc"})},I=r=>!z||z.key!==r?null:z.direction==="asc"?e.jsx(at,{className:"w-4 h-4 ml-1 text-blue-600"}):e.jsx(tt,{className:"w-4 h-4 ml-1 text-blue-600"}),$e=Y.filter(r=>{if(!ke)return!0;const t=ke.toLowerCase();return Te==="all"?Object.values(r).some(l=>String(l).toLowerCase().includes(t)):String(r[Te]).toLowerCase().includes(t)}),yr=z?[...$e].sort((r,t)=>{const l=r[z.key],u=t[z.key];return l<u?z.direction==="asc"?-1:1:l>u?z.direction==="asc"?1:-1:0}):$e,_r=r=>{const t=Cr(r);me(p?Y.map(l=>l.id===p.id?{...t,id:l.id}:l):[{...t,id:Date.now().toString()},...Y])},Cr=r=>{const t=m("maxGross")?typeof j(m("maxGross").formula,r)=="number"?j(m("maxGross").formula,r):Number(String(j(m("maxGross").formula,r)).replace(/\./g,"").replace(",",".")):r.maxGross,l=Number(t)||0,u={...r,maxGross:l},y=m("green")?typeof j(m("green").formula,u)=="number"?j(m("green").formula,u):Number(String(j(m("green").formula,u)).replace(/\./g,"").replace(",",".")):r.green,b=m("red")?typeof j(m("red").formula,u)=="number"?j(m("red").formula,u):Number(String(j(m("red").formula,u)).replace(/\./g,"").replace(",",".")):r.red,c=m("delta_number")?typeof j(m("delta_number").formula,u)=="number"?j(m("delta_number").formula,u):Number(String(j(m("delta_number").formula,u)).replace(/\./g,"").replace(",",".")):r.delta_number||0,E=m("delta_percentage")?(()=>{const _=m("delta_percentage");return _.formula&&_.formula.trim()!=="(green + red) / maxGross"?typeof j(_.formula,u)=="number"?j(_.formula,u):Number(String(j(_.formula,u)).replace(/\./g,"").replace(",",".")):l!==0?(r.green+r.red)/l*100:0})():r.delta_percentage||0;return{...r,maxGross:l,green:Number(y)||0,red:Number(b)||0,delta_number:Number(c)||0,delta_percentage:Number(E)||0,delta:0}},wr=r=>{S(r),o(!0)},kr=r=>{me(Y.filter(t=>t.id!==r))},[Z,Fe]=x.useState([{id:"main-cost-formula",name:"Max Bruto",formula:"IF(startup, Opstart * exOmw, 0) + netRun + (netRun * Marge) + (c4_4 * exOmw * param_4_4) + (c4_0 * exOmw * param_4_0) + (c1_0 * exOmw * param_1_0) + (c1_1 * exOmw * param_1_1) + (c4_1 * exOmw * param_4_1)",targetColumn:"maxGross"},{id:"delta-number-formula",name:"Delta Number",formula:"green + red - maxGross",targetColumn:"delta_number"},{id:"delta-percentage-formula",name:"Delta Percentage",formula:"(green + red) / maxGross",targetColumn:"delta_percentage"}]),[Tr,xe]=x.useState(!1),[ue,Se]=x.useState(null),[te,he]=x.useState(""),[U,Q]=x.useState(""),[Oe,pe]=x.useState(void 0),se=[{key:"pages",label:"Pagina's"},{key:"exOmw",label:"ex/omw."},{key:"netRun",label:"Oplage netto"},{key:"startup",label:"Opstart"},{key:"c4_4",label:"4/4"},{key:"c4_0",label:"4/0"},{key:"c1_0",label:"1/0"},{key:"c1_1",label:"1/1"},{key:"c4_1",label:"4/1"},{key:"maxGross",label:"Max Bruto"},{key:"green",label:"Groen"},{key:"red",label:"Rood"},{key:"delta",label:"Delta"}],ae=[{key:"Marge",label:"Marge"},{key:"Opstart",label:"Opstart"},{key:"param_4_4",label:"4/4"},{key:"param_4_0",label:"4/0"},{key:"param_1_0",label:"1/0"},{key:"param_1_1",label:"1/1"},{key:"param_4_1",label:"4/1"}],ze=["+","-","*","/","(",")"],ge=r=>{Q(t=>t+" "+r)},j=(r,t)=>{try{if(!r||!r.trim())return"";const l=(_,G,F)=>_?G:F,u=a.length>0?a[0]:"",y=u?P[u]:{};let b=r;const c=_=>_.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");se.forEach(_=>{const G=new RegExp(c(_.key),"g");let F=t[_.key];F===null&&(F=0),_.key==="startup"&&(F=F&&y.opstart||0),b=b.replace(G,String(F))}),ae.forEach(_=>{const G=new RegExp(c(_.key),"g");let F=_.key;_.key==="Marge"&&(F="marge"),_.key==="Opstart"&&(F="opstart");let K=y[F]||0;F==="marge"&&(K=(parseFloat((y.margePercentage||"0").replace(",","."))||0)/100),b=b.replace(G,String(K))});const E=Function("IF",'"use strict"; return ('+b+")")(l);return typeof E=="number"?(Math.round(E*100)/100).toLocaleString("nl-NL",{minimumFractionDigits:0,maximumFractionDigits:2}):E}catch(l){return console.error("Formula evaluation error:",l),""}},Ue={pages:{bg:"#dbeafe",text:"#1e40af"},exOmw:{bg:"#cffafe",text:"#0e7490"},netRun:{bg:"#ccfbf1",text:"#0f766e"},startup:{bg:"#d1fae5",text:"#047857"},c4_4:{bg:"#e0e7ff",text:"#4338ca"},c4_0:{bg:"#ede9fe",text:"#6d28d9"},c1_0:{bg:"#f3e8ff",text:"#7c3aed"},c1_1:{bg:"#fae8ff",text:"#a21caf"},c4_1:{bg:"#fce7f3",text:"#be185d"},Marge:{bg:"#dcfce7",text:"#15803d"},Opstart:{bg:"#ecfccb",text:"#4d7c0f"},param_4_4:{bg:"#fef9c3",text:"#a16207"},param_4_0:{bg:"#fef3c7",text:"#b45309"},param_1_0:{bg:"#ffedd5",text:"#c2410c"},param_1_1:{bg:"#fee2e2",text:"#b91c1c"},param_4_1:{bg:"#ffe4e6",text:"#be123c"}},Fr=(r,t)=>{if(!r||!r.trim())return null;const l=a.length>0?a[0]:"",u=l?P[l]:{},y=[];return se.forEach(b=>{if(r.includes(b.key)){let c=t[b.key];b.key==="startup"&&(c=c&&u.opstart||0),y.push({key:b.key,label:b.label,value:c,color:Ue[b.key]||{bg:"#f3f4f6",text:"#374151"}})}}),ae.forEach(b=>{if(r.includes(b.key)){let c=b.key;b.key==="Marge"&&(c="marge"),b.key==="Opstart"&&(c="opstart");let E=u[c]||0;c==="marge"&&(E=(parseFloat((u.margePercentage||"0").replace(",","."))||0)/100),y.push({key:b.key,label:b.label+" (param)",value:E,color:Ue[b.key]||{bg:"#f3f4f6",text:"#374151"}})}}),y},fe=({formula:r,job:t,result:l})=>{const u=Fr(r,t);if(!u||u.length===0)return e.jsx("span",{children:l});const y=new Map(u.map(c=>[c.key,c])),b=()=>{const c=u.map(F=>F.key).sort((F,K)=>K.length-F.length),E=F=>F.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),_=new RegExp(`(${c.map(E).join("|")})`,"g");return r.split(_).map((F,K)=>{const W=y.get(F);if(W){const Pe=typeof W.value=="number"?M(W.value):W.value;return e.jsx("span",{className:"inline-block px-1 py-0.5 rounded text-xs font-medium mx-0.5",style:{backgroundColor:W.color.bg,color:W.color.text},children:Pe},K)}return e.jsx("span",{style:{color:"#374151"},children:F},K)})};return e.jsxs(Pt,{children:[e.jsx(Rt,{asChild:!0,children:e.jsx("span",{className:"cursor-help border-b border-dashed border-gray-400",children:l})}),e.jsx(Dt,{side:"top",style:{backgroundColor:"white",color:"#1f2937"},className:"border border-gray-200 shadow-lg max-w-md p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-semibold",style:{color:"#4b5563"},children:"Formule berekening:"}),e.jsx("div",{className:"font-mono text-xs p-2 rounded border flex flex-wrap items-center",style:{backgroundColor:"#f3f4f6",borderColor:"#e5e7eb"},children:b()}),e.jsx("div",{className:"text-xs font-semibold mt-3 mb-1",style:{color:"#4b5563"},children:"Gebruikte waarden:"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:u.map((c,E)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium",style:{backgroundColor:c.color.bg,color:c.color.text},children:[e.jsxs("span",{style:{opacity:.7},children:[c.label,":"]}),e.jsx("span",{className:"font-bold",children:typeof c.value=="number"?M(c.value):c.value})]},E))}),e.jsxs("div",{className:"border-t pt-2 mt-2 flex items-center justify-between",style:{borderColor:"#e5e7eb"},children:[e.jsx("span",{className:"text-xs",style:{color:"#6b7280"},children:"Resultaat:"}),e.jsx("span",{className:"font-bold text-sm",style:{color:"#1f2937"},children:l})]})]})})]})},ne=(r,t)=>{r?(Se(r),he(r.name),Q(r.formula),pe(r.targetColumn)):(Se(null),he(""),Q(""),pe(t)),xe(!0)},Sr=()=>{if(!(!te.trim()||!U.trim())){if(ue)Fe(Z.map(r=>r.id===ue.id?{...r,name:te,formula:U,targetColumn:Oe}:r));else{const r={id:Date.now().toString(),name:te,formula:U,targetColumn:Oe};Fe([...Z,r])}xe(!1),he(""),Q(""),pe(void 0),Se(null)}},Or=r=>{Fe(Z.filter(t=>t.id!==r))},Pr=Y.length>0?j(U,Y[0]):"N/A";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(qr,{value:n,onValueChange:i,className:"w-full",children:[e.jsxs(Yr,{className:"flex w-full whitespace-nowrap",children:[e.jsx(De,{value:"werkorders",children:"Werkorders"}),e.jsx(De,{value:"finished",children:"Finished"}),e.jsx(De,{value:"parameters",children:"Parameters"})]}),e.jsx(Ee,{value:"werkorders",children:e.jsxs(be,{children:[e.jsxs(je,{children:[e.jsx(Ne,{className:"pl-4",children:"Werkorders"}),e.jsx(Qr,{children:e.jsxs(O,{onClick:()=>B(N),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"})," Werkorder"]})})]}),e.jsx(ve,{className:"space-y-4",children:d.map(r=>e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{className:"flex gap-4 w-full items-end",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(T,{children:"Order Nr"}),e.jsx(v,{value:`DT ${r.orderNr}`,readOnly:!0,style:{width:"85px"},className:"text-center p-0 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(T,{className:"pl-3",children:"Order"}),e.jsx(v,{value:r.orderName,readOnly:!0,className:"w-full border-0 focus-visible:ring-0 focus-visible:ring-offset-0"})]})]})}),e.jsxs(Me,{className:"table-fixed w-full",children:[e.jsx(Ae,{children:e.jsxs($,{children:[e.jsx(f,{style:{width:"60px"},children:"Order Date"}),e.jsx(f,{children:"Versie/Katern"}),e.jsx(f,{style:{width:"55px"},className:"text-center",children:"Pagina's"}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:"Ex/Omw."}),e.jsx(f,{style:{width:"100px"},children:"Oplage"}),e.jsx(f,{style:{width:"60px"},children:"Opstart"}),e.jsx(f,{style:{width:"55px"},className:"text-center",children:"4/4"}),e.jsx(f,{style:{width:"55px"},className:"text-center",children:"4/0"}),e.jsx(f,{style:{width:"55px"},className:"text-center",children:"1/0"}),e.jsx(f,{style:{width:"55px"},className:"text-center",children:"1/1"}),e.jsx(f,{style:{width:"55px"},className:"text-center",children:"4/1"}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:"Max Bruto"}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:"Groen"}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:"Rood"}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:"Delta"}),e.jsx(f,{style:{width:"55px"},className:"text-center",children:"Delta %"}),e.jsx(f,{style:{width:"100px"},children:"Actions"})]})}),e.jsx(Le,{children:r.katernen.map(t=>{const l=m("maxGross"),u=l?j(l.formula,t):String(t.maxGross),y=u?parseFloat(u.replace(/\./g,"").replace(",",".")):0,b={...t,maxGross:isNaN(y)?0:y};return e.jsxs($,{children:[e.jsx(g,{children:r.orderDate}),e.jsx(g,{children:e.jsx(v,{value:t.version,onChange:c=>k(r.id,t.id,"version",c.target.value)})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.pages??"",onChange:c=>k(r.id,t.id,"pages",c.target.value),className:"text-right"})}),e.jsx(g,{children:e.jsx(v,{value:t.exOmw,onChange:c=>k(r.id,t.id,"exOmw",c.target.value),className:"text-center px-0 py-0"})}),e.jsx(g,{children:e.jsx(v,{type:"number",value:t.netRun,onChange:c=>k(r.id,t.id,"netRun",c.target.value),className:"text-right"})}),e.jsx(g,{children:e.jsx(ce,{checked:t.startup,onCheckedChange:c=>k(r.id,t.id,"startup",c)})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.c4_4,onChange:c=>k(r.id,t.id,"c4_4",c.target.value),className:"text-center border-none focus-visible:ring-0 focus-visible:ring-offset-0"})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.c4_0,onChange:c=>k(r.id,t.id,"c4_0",c.target.value),className:"text-center border-none focus-visible:ring-0 focus-visible:ring-offset-0"})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.c1_0,onChange:c=>k(r.id,t.id,"c1_0",c.target.value),className:"text-center border-none focus-visible:ring-0 focus-visible:ring-offset-0"})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.c1_1,onChange:c=>k(r.id,t.id,"c1_1",c.target.value),className:"text-center border-none focus-visible:ring-0 focus-visible:ring-offset-0"})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.c4_1,onChange:c=>k(r.id,t.id,"c4_1",c.target.value),className:"text-center border-none focus-visible:ring-0 focus-visible:ring-offset-0"})}),e.jsx(g,{children:l?e.jsx(fe,{formula:l.formula,job:t,result:u}):M(t.maxGross)}),e.jsx(g,{children:e.jsx(v,{type:"number",value:t.green??"",onChange:c=>k(r.id,t.id,"green",c.target.value)})}),e.jsx(g,{children:e.jsx(v,{type:"number",value:t.red??"",onChange:c=>k(r.id,t.id,"red",c.target.value)})}),e.jsx(g,{children:(()=>{const c=m("delta_number");return c?j(c.formula,b):M(t.delta)})()}),e.jsx(g,{children:(()=>{const c=m("delta_percentage"),E=c?j(c.formula,b):t.deltaPercentage,_=typeof E=="string"?parseFloat(E.replace(/\./g,"").replace(",",".")):E;return isNaN(_)?"0.00%":`${(_*100).toFixed(2)}%`})()}),e.jsx(g,{children:e.jsx(O,{size:"sm",variant:"ghost",className:"hover:bg-red-100 text-red-500",children:e.jsx(Ge,{className:"w-4 h-4"})})})]},t.id)})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs(O,{onClick:()=>R(r.id),size:"sm",variant:"ghost",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"})," Add Katern/Versie"]}),e.jsx(O,{onClick:()=>J(r),size:"sm",className:"w-48",children:"Order Opslaan"})]})]},r.id))})]})}),e.jsx(Ee,{value:"finished",children:e.jsxs(be,{children:[e.jsxs(je,{className:"flex flex-row items-center justify-between",children:[e.jsx(Ne,{children:"Finished Print Jobs"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(qe,{value:Te,onValueChange:vr,children:[e.jsx(Ye,{className:"w-[130px]",children:e.jsx(Qe,{placeholder:"Filter by"})}),e.jsxs(Xe,{children:[e.jsx(q,{value:"all",children:"All Fields"}),e.jsx(q,{value:"orderNr",children:"Order Nr"}),e.jsx(q,{value:"orderName",children:"Order Name"}),e.jsx(q,{value:"date",children:"Date"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(et,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(v,{placeholder:"Search...",className:"pl-8 w-[200px]",value:ke,onChange:r=>Nr(r.target.value)})]}),e.jsxs(O,{onClick:()=>{S(null),o(!0)},children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Add Finished Job"]})]})]}),e.jsx(ve,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Me,{className:"table-fixed w-full",children:[e.jsxs(Ae,{children:[e.jsxs($,{children:[e.jsx(f,{colSpan:6,className:"text-center bg-blue-100",style:{borderRight:"1px solid black"},children:"Data"}),e.jsx(f,{colSpan:6,className:"text-center bg-green-100",style:{borderTop:"1px solid black",borderRight:"1px solid black"},children:"Wissels"}),e.jsx(f,{colSpan:3,className:"text-center bg-yellow-100",style:{borderTop:"1px solid black",borderRight:"1px solid black"},children:"Berekening"}),e.jsx(f,{colSpan:2,className:"text-center bg-purple-100",style:{borderTop:"1px solid black",borderRight:"1px solid black"},children:"Prestatie"}),e.jsx(f,{className:"w-[100px]"})]}),e.jsxs($,{children:[e.jsx(f,{onClick:()=>L("date"),style:{width:"83px"},className:"cursor-pointer hover:bg-gray-100 border-r",children:e.jsxs("div",{className:"flex items-center",children:["Date ",I("date")]})}),e.jsx(f,{onClick:()=>L("orderNr"),style:{width:"65px"},className:"cursor-pointer hover:bg-gray-100 border-r",children:e.jsxs("div",{className:"flex items-center",children:["Order nr ",I("orderNr")]})}),e.jsx(f,{onClick:()=>L("orderName"),className:"cursor-pointer hover:bg-gray-100 min-w-[150px] border-r",children:e.jsxs("div",{className:"flex items-center",children:["Order ",I("orderName")]})}),e.jsx(f,{onClick:()=>L("pages"),style:{width:"55px"},className:"cursor-pointer hover:bg-gray-100 text-center border-r",children:e.jsxs("div",{className:"flex items-center justify-center",children:["Blz ",I("pages")]})}),e.jsx(f,{onClick:()=>L("exOmw"),style:{width:"55px"},className:"cursor-pointer hover:bg-gray-100 text-center leading-3 border-r",children:e.jsxs("div",{className:"flex items-center justify-center h-full",children:["Ex/",e.jsx("br",{}),"Omw. ",I("exOmw")]})}),e.jsx(f,{onClick:()=>L("netRun"),style:{width:"100px"},className:"cursor-pointer hover:bg-gray-100 text-center border-r",children:e.jsxs("div",{className:"flex items-center justify-center",children:["Oplage netto ",I("netRun")]})}),e.jsx(f,{onClick:()=>L("startup"),style:{width:"55px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-center",children:["Opstart ",I("startup")]})}),e.jsx(f,{onClick:()=>L("c4_4"),style:{width:"55px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["4/4 ",I("c4_4")]})}),e.jsx(f,{onClick:()=>L("c4_0"),style:{width:"55px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["4/0 ",I("c4_0")]})}),e.jsx(f,{onClick:()=>L("c1_0"),style:{width:"55px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["1/0 ",I("c1_0")]})}),e.jsx(f,{onClick:()=>L("c1_1"),style:{width:"55px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["1/1 ",I("c1_1")]})}),e.jsx(f,{onClick:()=>L("c4_1"),style:{width:"55px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black border-r",children:e.jsxs("div",{className:"flex items-center justify-center",children:["4/1 ",I("c4_1")]})}),e.jsx(f,{style:{width:"90px"},className:"text-center border-r",children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(O,{variant:"ghost",className:"h-auto p-0 font-bold hover:bg-transparent hover:text-blue-600 truncate max-w-[60px]",onClick:()=>ne(m("maxGross"),"maxGross"),title:m("maxGross")?.name||"Max Bruto",children:m("maxGross")?.name||"Max Bruto"}),e.jsx("div",{onClick:()=>L("maxGross"),className:"cursor-pointer p-1 hover:bg-gray-200 rounded shrink-0",children:I("maxGross")})]})}),e.jsx(f,{style:{width:"90px"},className:"text-center border-r",children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(O,{variant:"ghost",className:"h-auto p-0 font-bold hover:bg-transparent hover:text-blue-600 truncate max-w-[60px]",onClick:()=>ne(m("green"),"green"),title:m("green")?.name||"Groen",children:m("green")?.name||"Groen"}),e.jsx("div",{onClick:()=>L("green"),className:"cursor-pointer p-1 hover:bg-gray-200 rounded shrink-0",children:I("green")})]})}),e.jsx(f,{style:{width:"90px",borderRight:"1px solid black"},className:"text-center",children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(O,{variant:"ghost",className:"h-auto p-0 font-bold hover:bg-transparent hover:text-blue-600 truncate max-w-[60px]",onClick:()=>ne(m("red"),"red"),title:m("red")?.name||"Rood",children:m("red")?.name||"Rood"}),e.jsx("div",{onClick:()=>L("red"),className:"cursor-pointer p-1 hover:bg-gray-200 rounded shrink-0",children:I("red")})]})}),e.jsx(f,{style:{width:"90px"},className:"text-center border-r",children:e.jsx("div",{className:"flex items-center gap-1 justify-center",children:e.jsx("span",{className:"font-bold",children:"Delta"})})}),e.jsx(f,{style:{width:"55px"},className:"text-center border-r",children:e.jsx("div",{className:"flex items-center gap-1 justify-center",children:e.jsx("span",{className:"font-bold",children:"Delta %"})})}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:e.jsx("div",{className:"flex items-center gap-1 justify-center",children:e.jsx("span",{className:"font-bold",children:"Acties"})})})]})]}),e.jsx(Le,{children:yr.map(r=>e.jsxs($,{children:[e.jsx(g,{children:r.date}),e.jsxs(g,{children:["DT ",r.orderNr]}),e.jsx(g,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:r.orderName}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mt-0.5",children:[e.jsx("span",{className:"w-3 h-3 border-l border-b border-gray-300 mr-1 rounded-bl-sm inline-block"}),r.version]})]})}),e.jsxs(g,{className:"text-center p-0",children:[M(r.pages)," blz"]}),e.jsx(g,{className:"text-center p-0",children:r.exOmw}),e.jsx(g,{className:"text-center p-0 border-r",children:M(r.netRun)}),e.jsx(g,{className:"text-center p-0 bg-gray-50",children:e.jsx("div",{className:"flex justify-center",children:r.startup?e.jsx(Xr,{className:"w-4 h-4 text-green-600"}):e.jsx("span",{className:"text-gray-300",children:"-"})})}),"                                                ",e.jsx(g,{className:"text-center p-0 bg-gray-50",children:M(r.c4_4)}),e.jsx(g,{className:"text-center p-0 bg-gray-50",children:M(r.c4_0)}),e.jsx(g,{className:"text-center p-0 bg-gray-50",children:M(r.c1_0)}),e.jsx(g,{className:"text-center p-0 bg-gray-50",children:M(r.c1_1)}),e.jsx(g,{className:"text-center p-0 bg-gray-50 border-r",children:M(r.c4_1)}),e.jsx(g,{className:"p-0 text-center",children:(()=>{const t=m("maxGross");return t?e.jsx(fe,{formula:t.formula,job:r,result:j(t.formula,r)}):M(r.maxGross)})()}),e.jsx(g,{className:"p-0 text-center",children:(()=>{const t=m("green");return t?e.jsx(fe,{formula:t.formula,job:r,result:j(t.formula,r)}):M(r.green)})()}),e.jsx(g,{className:"p-0 text-center",style:{borderRight:"1px solid black"},children:(()=>{const t=m("red");return t?e.jsx(fe,{formula:t.formula,job:r,result:j(t.formula,r)}):M(r.red)})()}),e.jsx(g,{className:"text-center p-0",children:(()=>{const t=m("delta_number");return M(t?j(t.formula,r):r.delta_number)})()}),e.jsx(g,{className:"text-center p-0 border-r",children:(()=>{const t=m("delta_percentage"),l=t?j(t.formula,r):M(r.delta_percentage),u=typeof l=="string"?parseFloat(l.replace(/\./g,"").replace(",","."))*100:l*100,y=Math.round(u*100)/100;return y+"%"})()}),e.jsx(g,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(O,{size:"sm",variant:"ghost",className:"hover:bg-blue-100 text-blue-600",onClick:()=>wr(r),children:e.jsx(er,{className:"w-4 h-4"})}),e.jsx(O,{size:"sm",variant:"ghost",className:"hover:bg-red-100 text-red-500",onClick:()=>kr(r.id),children:e.jsx(Ge,{className:"w-4 h-4"})})]})})]},r.id))})]})})})]})}),e.jsx(Ee,{value:"parameters",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(be,{children:[e.jsx(je,{children:e.jsx(Ne,{children:"Parameters"})}),e.jsxs(ve,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Me,{children:[e.jsx(Ae,{children:e.jsxs($,{children:[e.jsx(f,{className:"w-[200px]",children:"Parameter"}),e.jsx(f,{className:"w-[50px] text-center",children:"Link"}),a.map(r=>e.jsx(f,{className:"text-center min-w-[120px]",children:r},r))]})}),e.jsxs(Le,{children:[e.jsxs($,{children:[e.jsx(g,{className:"font-medium",children:"Marge"}),e.jsx(g,{className:"text-center",children:e.jsx(ce,{checked:V.margePercentage,onCheckedChange:()=>we("margePercentage")})}),a.map(r=>e.jsx(g,{children:e.jsx("div",{className:"flex gap-2",children:e.jsx(v,{type:"text",placeholder:"%",className:"h-8",value:P[r]?.margePercentage||"",onChange:t=>X(r,"margePercentage",t.target.value)})})},r))]}),e.jsxs($,{children:[e.jsx(g,{className:"font-medium",children:"Opstart"}),e.jsx(g,{className:"text-center",children:e.jsx(ce,{checked:V.opstart,onCheckedChange:()=>we("opstart")})}),a.map(r=>e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",className:"h-8",value:P[r]?.opstart||0,onChange:t=>X(r,"opstart",Number(t.target.value))})},r))]}),[{id:"param_4_4",label:"4/4"},{id:"param_4_0",label:"4/0"},{id:"param_1_0",label:"1/0"},{id:"param_1_1",label:"1/1"},{id:"param_4_1",label:"4/1"}].map(r=>e.jsxs($,{children:[e.jsx(g,{className:"font-medium",children:r.label}),e.jsx(g,{className:"text-center",children:e.jsx(ce,{checked:V[r.id],onCheckedChange:()=>we(r.id)})}),a.map(t=>e.jsx(g,{children:e.jsx(v,{type:"number",className:"h-8",value:P[t]?.[r.id]||0,onChange:l=>X(t,r.id,Number(l.target.value))})},t))]},r.id))]})]})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(O,{children:"Save Changes"})})]})]}),e.jsxs(be,{children:[e.jsxs(je,{className:"flex flex-row items-center justify-between",children:[e.jsx(Ne,{children:"Calculated Fields"}),e.jsxs(O,{onClick:()=>ne(),className:"gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Add Formula"]})]}),e.jsx(ve,{children:Z.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:'No calculated fields yet. Click "Add Formula" to create one.'}):e.jsx("div",{className:"space-y-2",children:Z.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:r.name}),e.jsx("div",{className:"text-sm text-gray-600 font-mono",children:r.formula}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Preview: ",j(r.formula,Y[0])]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>ne(r),children:e.jsx(er,{className:"w-4 h-4"})}),e.jsx(O,{variant:"ghost",size:"sm",onClick:()=>Or(r.id),children:e.jsx(Ge,{className:"w-4 h-4 text-red-500"})})]})]},r.id))})})]})]})})]}),e.jsx(Et,{open:h,onOpenChange:o,onSubmit:_r,editJob:p}),e.jsx(ar,{open:Tr,onOpenChange:xe,children:e.jsxs(nr,{className:"max-w-2xl",children:[e.jsxs(lr,{children:[e.jsxs(cr,{className:"flex items-center gap-2",children:[e.jsx(lt,{className:"w-5 h-5"}),ue?"Edit Formula":"Create Calculated Field"]}),e.jsx(or,{children:"Build a formula by clicking on fields, operators, and numbers below."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{htmlFor:"formula-name",children:"Field Name *"}),e.jsx(v,{id:"formula-name",placeholder:"e.g., Total Cost",value:te,onChange:r=>he(r.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"Target Column (Optional)"}),e.jsxs(qe,{value:Oe||"none",onValueChange:r=>pe(r==="none"?void 0:r),children:[e.jsx(Ye,{children:e.jsx(Qe,{placeholder:"Select a column to display this formula"})}),e.jsxs(Xe,{children:[e.jsx(q,{value:"none",children:"None (Reference only)"}),e.jsx(q,{value:"maxGross",children:"Max Bruto"}),e.jsx(q,{value:"delta_number",children:"Delta Number"}),e.jsx(q,{value:"delta_percentage",children:"Delta Percentage"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(T,{children:"Formula"}),e.jsx(v,{value:U,onChange:r=>Q(r.target.value),placeholder:"Type or click fields below to build formula...",className:"font-mono"}),e.jsx("div",{className:"p-3 border rounded-md bg-gray-50 min-h-[60px] flex flex-wrap gap-2 items-center",children:U?U.split(" ").filter(r=>r).map((r,t)=>{const l=se.some(b=>b.key===r)||ae.some(b=>b.key===r),u=ze.includes(r),y=!isNaN(Number(r))&&r!=="";if(l){const b=se.find(c=>c.key===r)||ae.find(c=>c.key===r);return e.jsx(Ie,{variant:"outline",className:"bg-blue-50 border-blue-200",children:b?.label||r},t)}else return u?e.jsx("span",{className:"px-2 py-1 bg-gray-200 rounded font-mono text-sm",children:r},t):y?e.jsx("span",{className:"px-2 py-1 bg-green-50 border border-green-200 rounded font-mono text-sm",children:r},t):e.jsx("span",{className:"font-mono text-sm",children:r},t)}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Formula will appear here..."})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(O,{variant:"outline",size:"sm",onClick:()=>Q(""),children:"Clear"}),e.jsx(O,{variant:"outline",size:"sm",onClick:()=>Q(r=>r.trim().split(" ").slice(0,-1).join(" ")),children:"Remove Last"})]})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{children:[e.jsx(T,{className:"text-xs text-gray-600",children:"Finished Job Fields"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:se.map(r=>e.jsx(Ie,{variant:"outline",className:"cursor-pointer hover:bg-blue-100",onClick:()=>ge(r.key),children:r.label},r.key))})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs text-gray-600",children:"Parameters"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:ae.map(r=>e.jsx(Ie,{variant:"outline",className:"cursor-pointer hover:bg-green-100",onClick:()=>ge(r.key),children:r.label},r.key))})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs text-gray-600",children:"Operators"}),e.jsx("div",{className:"flex gap-2 mt-2",children:ze.map(r=>e.jsx(O,{variant:"outline",size:"sm",onClick:()=>ge(r),className:"w-10",children:r},r))})]}),e.jsxs("div",{children:[e.jsx(T,{className:"text-xs text-gray-600",children:"Number"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(v,{type:"number",placeholder:"Enter number",className:"w-32",onKeyDown:r=>{r.key==="Enter"&&(ge(r.target.value),r.target.value="")}}),e.jsx("span",{className:"text-xs text-gray-500 self-center",children:"Press Enter to add"})]})]})]}),e.jsxs("div",{className:"p-3 border rounded-md bg-blue-50",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Preview Result"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-1",children:Pr}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Using first job data with sample parameter values"})]})]}),e.jsxs(ir,{children:[e.jsx(O,{variant:"outline",onClick:()=>xe(!1),children:"Cancel"}),e.jsx(O,{onClick:Sr,disabled:!te.trim()||!U.trim(),children:ue?"Update Formula":"Save Formula"})]})]})})]})}export{Kt as Drukwerken};
