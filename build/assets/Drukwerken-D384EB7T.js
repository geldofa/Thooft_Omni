import{c as Ve,j as e,r as u,X as Sr,ac as Ze,ad as Pr,W as Rr,ae as Dr,V as er,af as Er,Y as Gr,Z as ee,ag as rr,ah as Mr,ai as Lr,aj as Ar,ak as Ir,al as Br,a as Vr,D as tr,b as sr,d as ar,e as nr,f as lr,L as F,P as Jr,g as Kr,B as S,C as Hr,h as Wr,i as $r,I as v,k as cr,t as Se,A as zr,E as Ur,F as Pe,H as Re,am as fe,an as be,ao as je,ap as qr,aq as Ne,T as De,M as ze,N as Ue,O as qe,Q as Ye,R as q,J as Yr,ar as Qe}from"./index-B2Je7hCw.js";import{T as Ee,a as Ge,b as $,c as f,d as Me,e as g}from"./table-CarMYJHm.js";import{B as Le}from"./badge-CLUY4IPe.js";import{C as ce}from"./checkbox-Cy4Vm1_R.js";import{P as ve,S as Xe}from"./square-pen-jCmBbfaz.js";import{S as Qr}from"./search-BRNztPY7.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Zr=Ve("arrow-down",Xr);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],rt=Ve("arrow-up",et);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],st=Ve("calculator",tt),M=(s,a=0)=>{if(s==null||s==="")return"";const n=typeof s=="string"?parseFloat(s):s;return isNaN(n)?"":n.toLocaleString("nl-NL",{minimumFractionDigits:a,maximumFractionDigits:a,useGrouping:!0})};var at=Symbol("radix.slottable");function nt(s){const a=({children:n})=>e.jsx(e.Fragment,{children:n});return a.displayName=`${s}.Slottable`,a.__radixId=at,a}var[ye]=Sr("Tooltip",[Ze]),_e=Ze(),or="TooltipProvider",lt=700,Ie="tooltip.open",[ct,Je]=ye(or),ir=s=>{const{__scopeTooltip:a,delayDuration:n=lt,skipDelayDuration:d=300,disableHoverableContent:m=!1,children:o}=s,p=u.useRef(!0),P=u.useRef(!1),N=u.useRef(0);return u.useEffect(()=>{const y=N.current;return()=>window.clearTimeout(y)},[]),e.jsx(ct,{scope:a,isOpenDelayedRef:p,delayDuration:n,onOpen:u.useCallback(()=>{window.clearTimeout(N.current),p.current=!1},[]),onClose:u.useCallback(()=>{window.clearTimeout(N.current),N.current=window.setTimeout(()=>p.current=!0,d)},[d]),isPointerInTransitRef:P,onPointerInTransitChange:u.useCallback(y=>{P.current=y},[]),disableHoverableContent:m,children:o})};ir.displayName=or;var oe="Tooltip",[ot,ie]=ye(oe),dr=s=>{const{__scopeTooltip:a,children:n,open:d,defaultOpen:m,onOpenChange:o,disableHoverableContent:p,delayDuration:P}=s,N=Je(oe,s.__scopeTooltip),y=_e(a),[h,w]=u.useState(null),R=Pr(),D=u.useRef(0),k=p??N.disableHoverableContent,I=P??N.delayDuration,O=u.useRef(!1),[B,i]=Rr({prop:d,defaultProp:m??!1,onChange:J=>{J?(N.onOpen(),document.dispatchEvent(new CustomEvent(Ie))):N.onClose(),o?.(J)},caller:oe}),V=u.useMemo(()=>B?O.current?"delayed-open":"instant-open":"closed",[B]),Y=u.useCallback(()=>{window.clearTimeout(D.current),D.current=0,O.current=!1,i(!0)},[i]),H=u.useCallback(()=>{window.clearTimeout(D.current),D.current=0,i(!1)},[i]),X=u.useCallback(()=>{window.clearTimeout(D.current),D.current=window.setTimeout(()=>{O.current=!0,i(!0),D.current=0},I)},[I,i]);return u.useEffect(()=>()=>{D.current&&(window.clearTimeout(D.current),D.current=0)},[]),e.jsx(Dr,{...y,children:e.jsx(ot,{scope:a,contentId:R,open:B,stateAttribute:V,trigger:h,onTriggerChange:w,onTriggerEnter:u.useCallback(()=>{N.isOpenDelayedRef.current?X():Y()},[N.isOpenDelayedRef,X,Y]),onTriggerLeave:u.useCallback(()=>{k?H():(window.clearTimeout(D.current),D.current=0)},[H,k]),onOpen:Y,onClose:H,disableHoverableContent:k,children:n})})};dr.displayName=oe;var Be="TooltipTrigger",mr=u.forwardRef((s,a)=>{const{__scopeTooltip:n,...d}=s,m=ie(Be,n),o=Je(Be,n),p=_e(n),P=u.useRef(null),N=er(a,P,m.onTriggerChange),y=u.useRef(!1),h=u.useRef(!1),w=u.useCallback(()=>y.current=!1,[]);return u.useEffect(()=>()=>document.removeEventListener("pointerup",w),[w]),e.jsx(Er,{asChild:!0,...p,children:e.jsx(Gr.button,{"aria-describedby":m.open?m.contentId:void 0,"data-state":m.stateAttribute,...d,ref:N,onPointerMove:ee(s.onPointerMove,R=>{R.pointerType!=="touch"&&!h.current&&!o.isPointerInTransitRef.current&&(m.onTriggerEnter(),h.current=!0)}),onPointerLeave:ee(s.onPointerLeave,()=>{m.onTriggerLeave(),h.current=!1}),onPointerDown:ee(s.onPointerDown,()=>{m.open&&m.onClose(),y.current=!0,document.addEventListener("pointerup",w,{once:!0})}),onFocus:ee(s.onFocus,()=>{y.current||m.onOpen()}),onBlur:ee(s.onBlur,m.onClose),onClick:ee(s.onClick,m.onClose)})})});mr.displayName=Be;var Ke="TooltipPortal",[it,dt]=ye(Ke,{forceMount:void 0}),xr=s=>{const{__scopeTooltip:a,forceMount:n,children:d,container:m}=s,o=ie(Ke,a);return e.jsx(it,{scope:a,forceMount:n,children:e.jsx(rr,{present:n||o.open,children:e.jsx(Mr,{asChild:!0,container:m,children:d})})})};xr.displayName=Ke;var re="TooltipContent",ur=u.forwardRef((s,a)=>{const n=dt(re,s.__scopeTooltip),{forceMount:d=n.forceMount,side:m="top",...o}=s,p=ie(re,s.__scopeTooltip);return e.jsx(rr,{present:d||p.open,children:p.disableHoverableContent?e.jsx(hr,{side:m,...o,ref:a}):e.jsx(mt,{side:m,...o,ref:a})})}),mt=u.forwardRef((s,a)=>{const n=ie(re,s.__scopeTooltip),d=Je(re,s.__scopeTooltip),m=u.useRef(null),o=er(a,m),[p,P]=u.useState(null),{trigger:N,onClose:y}=n,h=m.current,{onPointerInTransitChange:w}=d,R=u.useCallback(()=>{P(null),w(!1)},[w]),D=u.useCallback((k,I)=>{const O=k.currentTarget,B={x:k.clientX,y:k.clientY},i=pt(B,O.getBoundingClientRect()),V=gt(B,i),Y=ft(I.getBoundingClientRect()),H=jt([...V,...Y]);P(H),w(!0)},[w]);return u.useEffect(()=>()=>R(),[R]),u.useEffect(()=>{if(N&&h){const k=O=>D(O,h),I=O=>D(O,N);return N.addEventListener("pointerleave",k),h.addEventListener("pointerleave",I),()=>{N.removeEventListener("pointerleave",k),h.removeEventListener("pointerleave",I)}}},[N,h,D,R]),u.useEffect(()=>{if(p){const k=I=>{const O=I.target,B={x:I.clientX,y:I.clientY},i=N?.contains(O)||h?.contains(O),V=!bt(B,p);i?R():V&&(R(),y())};return document.addEventListener("pointermove",k),()=>document.removeEventListener("pointermove",k)}},[N,h,p,y,R]),e.jsx(hr,{...s,ref:o})}),[xt,ut]=ye(oe,{isInside:!1}),ht=nt("TooltipContent"),hr=u.forwardRef((s,a)=>{const{__scopeTooltip:n,children:d,"aria-label":m,onEscapeKeyDown:o,onPointerDownOutside:p,...P}=s,N=ie(re,n),y=_e(n),{onClose:h}=N;return u.useEffect(()=>(document.addEventListener(Ie,h),()=>document.removeEventListener(Ie,h)),[h]),u.useEffect(()=>{if(N.trigger){const w=R=>{R.target?.contains(N.trigger)&&h()};return window.addEventListener("scroll",w,{capture:!0}),()=>window.removeEventListener("scroll",w,{capture:!0})}},[N.trigger,h]),e.jsx(Ar,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:o,onPointerDownOutside:p,onFocusOutside:w=>w.preventDefault(),onDismiss:h,children:e.jsxs(Ir,{"data-state":N.stateAttribute,...y,...P,ref:a,style:{...P.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(ht,{children:d}),e.jsx(xt,{scope:n,isInside:!0,children:e.jsx(Br,{id:N.contentId,role:"tooltip",children:m||d})})]})})});ur.displayName=re;var pr="TooltipArrow",gr=u.forwardRef((s,a)=>{const{__scopeTooltip:n,...d}=s,m=_e(n);return ut(pr,n).isInside?null:e.jsx(Lr,{...m,...d,ref:a})});gr.displayName=pr;function pt(s,a){const n=Math.abs(a.top-s.y),d=Math.abs(a.bottom-s.y),m=Math.abs(a.right-s.x),o=Math.abs(a.left-s.x);switch(Math.min(n,d,m,o)){case o:return"left";case m:return"right";case n:return"top";case d:return"bottom";default:throw new Error("unreachable")}}function gt(s,a,n=5){const d=[];switch(a){case"top":d.push({x:s.x-n,y:s.y+n},{x:s.x+n,y:s.y+n});break;case"bottom":d.push({x:s.x-n,y:s.y-n},{x:s.x+n,y:s.y-n});break;case"left":d.push({x:s.x+n,y:s.y-n},{x:s.x+n,y:s.y+n});break;case"right":d.push({x:s.x-n,y:s.y-n},{x:s.x-n,y:s.y+n});break}return d}function ft(s){const{top:a,right:n,bottom:d,left:m}=s;return[{x:m,y:a},{x:n,y:a},{x:n,y:d},{x:m,y:d}]}function bt(s,a){const{x:n,y:d}=s;let m=!1;for(let o=0,p=a.length-1;o<a.length;p=o++){const P=a[o],N=a[p],y=P.x,h=P.y,w=N.x,R=N.y;h>d!=R>d&&n<(w-y)*(d-h)/(R-h)+y&&(m=!m)}return m}function jt(s){const a=s.slice();return a.sort((n,d)=>n.x<d.x?-1:n.x>d.x?1:n.y<d.y?-1:n.y>d.y?1:0),Nt(a)}function Nt(s){if(s.length<=1)return s.slice();const a=[];for(let d=0;d<s.length;d++){const m=s[d];for(;a.length>=2;){const o=a[a.length-1],p=a[a.length-2];if((o.x-p.x)*(m.y-p.y)>=(o.y-p.y)*(m.x-p.x))a.pop();else break}a.push(m)}a.pop();const n=[];for(let d=s.length-1;d>=0;d--){const m=s[d];for(;n.length>=2;){const o=n[n.length-1],p=n[n.length-2];if((o.x-p.x)*(m.y-p.y)>=(o.y-p.y)*(m.x-p.x))n.pop();else break}n.push(m)}return n.pop(),a.length===1&&n.length===1&&a[0].x===n[0].x&&a[0].y===n[0].y?a:a.concat(n)}var vt=ir,yt=dr,_t=mr,Ct=xr,wt=ur,kt=gr;function Tt({delayDuration:s=0,...a}){return e.jsx(vt,{"data-slot":"tooltip-provider",delayDuration:s,...a})}function Ft({...s}){return e.jsx(Tt,{children:e.jsx(yt,{"data-slot":"tooltip",...s})})}function Ot({...s}){return e.jsx(_t,{"data-slot":"tooltip-trigger",...s})}function St({className:s,sideOffset:a=0,children:n,...d}){return e.jsx(Ct,{children:e.jsxs(wt,{"data-slot":"tooltip-content",sideOffset:a,className:Vr("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",s),...d,children:[n,e.jsx(kt,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}const Ae=({value:s,onChange:a,className:n})=>{const[d,m]=u.useState(()=>s!==null?new Intl.NumberFormat("nl-NL").format(Number(s)):""),[o,p]=u.useState(!1);u.useEffect(()=>{o||m(s!==null?new Intl.NumberFormat("nl-NL").format(Number(s)):"")},[s,o]);const P=()=>{p(!0),m(String(s??""))},N=()=>{p(!1)},y=h=>{const w=h.target.value.replace(/\./g,"").replace(/[^\d]/g,"");m(h.target.value);const R=parseInt(w,10);a(isNaN(R)?null:R)};return e.jsx(v,{value:d,onChange:y,onFocus:P,onBlur:N,className:n,inputMode:"numeric"})};function Pt({open:s,onOpenChange:a,onSubmit:n,editJob:d}){const m={date:new Date().toISOString().split("T")[0],datum:"",orderNr:"",orderName:"",version:"",pages:null,exOmw:"",netRun:null,startup:!1,c4_4:null,c4_0:null,c1_0:null,c1_1:null,c4_1:null,maxGross:0,green:null,red:null,delta:0,delta_number:0,delta_percentage:0,performance:""},[o,p]=u.useState(m);u.useEffect(()=>{if(s)if(d){const{id:h,...w}=d;p(w)}else p(m)},[d,s]);const P=h=>{if(h.preventDefault(),!o.orderNr.trim()||!o.orderName.trim()){Se.error("Please fill out Order Nr and Order Name");return}n(o),a(!1),d?Se.success("Job updated successfully"):Se.success("Job added successfully")},N=h=>h?new Date(h).toLocaleDateString("nl-BE",{year:"numeric",month:"short",day:"numeric"}):"Pick a date",y=h=>w=>{p({...o,[h]:w.target.value===""?null:Number(w.target.value)})};return e.jsx(tr,{open:s,onOpenChange:a,children:e.jsxs(sr,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(ar,{children:[e.jsx(nr,{children:d?"Edit Finished Job":"Add Finished Job"}),e.jsx(lr,{children:d?"Update the job details below.":"Fill in the details for the new finished job."})]}),e.jsxs("form",{onSubmit:P,children:[e.jsxs("div",{className:"grid gap-2 py-2",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"date",className:"text-right text-xs",children:"Date"}),e.jsxs(Jr,{children:[e.jsx(Kr,{asChild:!0,children:e.jsxs(S,{variant:"outline",className:"col-span-3 justify-start text-left text-xs h-8",children:[e.jsx(Hr,{className:"mr-2 h-4 w-4"}),N(o.date)]})}),e.jsx(Wr,{className:"w-auto p-0",align:"start",children:e.jsx($r,{mode:"single",selected:new Date(o.date),onSelect:h=>p({...o,date:h?.toISOString().split("T")[0]||""}),initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"orderNr",className:"text-right text-xs",children:"Order Nr."}),e.jsx(v,{id:"orderNr",value:o.orderNr,onChange:h=>p({...o,orderNr:h.target.value}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"orderName",className:"text-right text-xs",children:"Order"}),e.jsx(v,{id:"orderName",value:o.orderName,onChange:h=>p({...o,orderName:h.target.value}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"version",className:"text-right text-xs",children:"Version/Katern"}),e.jsx(v,{id:"version",value:o.version,onChange:h=>p({...o,version:h.target.value}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"pages",className:"text-right text-xs",children:"Pages"}),e.jsx(v,{id:"pages",type:"number",value:o.pages??"",onChange:y("pages"),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"exOmw",className:"text-right text-xs",children:"Ex/Omw."}),e.jsx(v,{id:"exOmw",value:o.exOmw,onChange:h=>p({...o,exOmw:h.target.value}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"netRun",className:"text-right text-xs",children:"Oplage Netto"}),e.jsx(Ae,{value:o.netRun,onChange:h=>p({...o,netRun:h}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"startup",className:"text-right text-xs",children:"Opstart"}),e.jsx("div",{className:"col-span-3 flex items-center",children:e.jsx(ce,{id:"startup",checked:o.startup,onCheckedChange:h=>p({...o,startup:!!h})})})]}),e.jsx("h3",{className:"font-semibold col-span-4 pt-2 text-sm",children:"Wissels"}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"c4_4",className:"text-right text-xs",children:"4/4"}),e.jsx(v,{id:"c4_4",type:"number",value:o.c4_4??"",onChange:y("c4_4"),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"c4_0",className:"text-right text-xs",children:"4/0"}),e.jsx(v,{id:"c4_0",type:"number",value:o.c4_0??"",onChange:y("c4_0"),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"c1_0",className:"text-right text-xs",children:"1/0"}),e.jsx(v,{id:"c1_0",type:"number",value:o.c1_0??"",onChange:y("c1_0"),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"c1_1",className:"text-right text-xs",children:"1/1"}),e.jsx(v,{id:"c1_1",type:"number",value:o.c1_1??"",onChange:y("c1_1"),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"c4_1",className:"text-right text-xs",children:"4/1"}),e.jsx(v,{id:"c4_1",type:"number",value:o.c4_1??"",onChange:y("c4_1"),className:"col-span-3 text-xs h-8"})]}),e.jsx("h3",{className:"font-semibold col-span-4 pt-2 text-sm",children:"Resultaten"}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"green",className:"text-right text-xs",children:"Groen"}),e.jsx(Ae,{value:o.green,onChange:h=>p({...o,green:h}),className:"col-span-3 text-xs h-8"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-2",children:[e.jsx(F,{htmlFor:"red",className:"text-right text-xs",children:"Rood"}),e.jsx(Ae,{value:o.red,onChange:h=>p({...o,red:h}),className:"col-span-3 text-xs h-8"})]})]}),e.jsxs(cr,{children:[e.jsx(S,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(S,{type:"submit",children:d?"Update Job":"Add Job"})]})]})]})})}function It({presses:s}){const a=s.filter(r=>r.active&&!r.archived).map(r=>r.name),[n,d]=u.useState(!1),[m,o]=u.useState(null),p={orderNr:"",orderName:"New Werkorder",orderDate:new Date().toISOString().split("T")[0]},P={version:"",pages:null,exOmw:"",netRun:0,startup:!1,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:null,red:null,delta:0,deltaPercentage:0},[N,y]=u.useState([{id:"1",orderNr:"0001",orderName:"Spar 2025-01",orderDate:"2025-01-01",katernen:[{id:"1-1",version:"Nederlands - Katern 1",pages:40,exOmw:"2",netRun:1e5,startup:!0,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:101e3,red:3e3,delta:0,deltaPercentage:0},{id:"1-2",version:"Frans - Katern 1",pages:40,exOmw:"2",netRun:5e4,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:50500,red:1500,delta:0,deltaPercentage:0}]}]),h=r=>{w(P,r)},w=(r,t)=>{y(N.map(l=>{if(l.id===t){const x={...r,id:`${l.id}-${l.katernen.length+1}`};return{...l,katernen:[...l.katernen,x]}}return l}))},R={id:"new-katern-1",version:"",pages:null,exOmw:"",netRun:0,startup:!1,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:null,red:null,delta:0,deltaPercentage:0},D=r=>{const t=Date.now().toString(),l={...R,id:`${t}-1`},x={...r,id:t,katernen:[l]};y([x,...N])},k=(r,t,l,x)=>{y(_=>_.map(b=>b.id===r?{...b,katernen:b.katernen.map(c=>{if(c.id===t){if(["pages","netRun","c4_4","c4_0","c1_0","c1_1","c4_1","green","red"].includes(l)){const E=x===""?null:Number(x);return{...c,[l]:E}}return l==="startup"?{...c,[l]:!!x}:{...c,[l]:x}}return c})}:b))},I=r=>{const t=r.katernen.map(l=>{const x=new Date,_=Qe(x,"yyyy-MM-dd"),b=Qe(x,"dd-MM"),c={...l,orderNr:r.orderNr,orderName:r.orderName,date:_,datum:b},E=i("maxGross")?typeof j(i("maxGross").formula,c)=="number"?j(i("maxGross").formula,c):Number(String(j(i("maxGross").formula,c)).replace(/\./g,"").replace(",",".")):l.maxGross,C=Number(E)||0,G={...c,maxGross:C},T=i("green")?typeof j(i("green").formula,G)=="number"?j(i("green").formula,G):Number(String(j(i("green").formula,G)).replace(/\./g,"").replace(",",".")):l.green,K=i("red")?typeof j(i("red").formula,G)=="number"?j(i("red").formula,G):Number(String(j(i("red").formula,G)).replace(/\./g,"").replace(",",".")):l.red,W=i("delta_number")?typeof j(i("delta_number").formula,G)=="number"?j(i("delta_number").formula,G):Number(String(j(i("delta_number").formula,G)).replace(/\./g,"").replace(",",".")):l.delta,Oe=i("delta_percentage")?(()=>{const le=i("delta_percentage");return le.formula&&le.formula.trim()!=="(green + red) / maxGross"?typeof j(le.formula,G)=="number"?j(le.formula,G):Number(String(j(le.formula,G)).replace(/\./g,"").replace(",",".")):C!==0?(Number(T)+Number(K))/C*100:0})():l.deltaPercentage;return{id:Date.now().toString()+"-"+l.id,date:_,datum:b,orderNr:r.orderNr,orderName:r.orderName,version:l.version,pages:l.pages,exOmw:l.exOmw,netRun:l.netRun,startup:l.startup,c4_4:l.c4_4,c4_0:l.c4_0,c1_0:l.c1_0,c1_1:l.c1_1,c4_1:l.c4_1,maxGross:C,green:Number(T)||0,red:Number(K)||0,delta_number:Number(W)||0,delta_percentage:Number(Oe)||0,delta:Number(W)||0,performance:"100%"}});de(l=>[...t,...l])},[O,B]=u.useState(()=>{const r={};return a.forEach(t=>{r[t]={marge:0,margePercentage:"4,2",opstart:6e3,param_4_4:4e3,param_4_0:3e3,param_1_0:1500,param_1_1:2e3,param_4_1:3500}}),r}),i=r=>Z.find(t=>t.targetColumn===r),[V,Y]=u.useState({marge:!1,margePercentage:!1,opstart:!1,param_4_4:!1,param_4_0:!1,param_1_0:!1,param_1_1:!1,param_4_1:!1}),H=(r,t,l)=>{if(V[t]){const x={...O};a.forEach(_=>{x[_]={...x[_],[t]:l}}),B(x)}else B({...O,[r]:{...O[r],[t]:l}})},X=r=>{const t=!V[r];if(Y({...V,[r]:t}),t&&a.length>0){const l=O[a[0]][r],x={...O};a.forEach(_=>{x[_]={...x[_],[r]:l}}),B(x)}},[J,de]=u.useState([{id:"1",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Nederlands - Katern 1",pages:40,exOmw:"2",netRun:1e5,startup:!0,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:101e3,red:3e3,delta_number:0,delta_percentage:0,delta:0,performance:"100%"},{id:"2",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Frans - Katern 1",pages:40,exOmw:"2",netRun:5e4,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:50500,red:1500,delta_number:0,delta_percentage:0,delta:0,performance:"100%"},{id:"3",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Nederlands - Katern 2",pages:32,exOmw:"2",netRun:1e5,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:101e3,red:3e3,delta_number:0,delta_percentage:0,delta:0,performance:"100%"},{id:"4",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Frans - Katern 2",pages:32,exOmw:"2",netRun:5e4,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:50500,red:1500,delta_number:0,delta_percentage:0,delta:0,performance:"100%"}]),[z,fr]=u.useState(null),[Ce,br]=u.useState(""),[we,jr]=u.useState("all"),L=r=>{fr(t=>t?.key===r?t.direction==="asc"?{key:r,direction:"desc"}:null:{key:r,direction:"asc"})},A=r=>!z||z.key!==r?null:z.direction==="asc"?e.jsx(rt,{className:"w-4 h-4 ml-1 text-blue-600"}):e.jsx(Zr,{className:"w-4 h-4 ml-1 text-blue-600"}),He=J.filter(r=>{if(!Ce)return!0;const t=Ce.toLowerCase();return we==="all"?Object.values(r).some(l=>String(l).toLowerCase().includes(t)):String(r[we]).toLowerCase().includes(t)}),Nr=z?[...He].sort((r,t)=>{const l=r[z.key],x=t[z.key];return l<x?z.direction==="asc"?-1:1:l>x?z.direction==="asc"?1:-1:0}):He,vr=r=>{const t=yr(r);de(m?J.map(l=>l.id===m.id?{...t,id:l.id}:l):[{...t,id:Date.now().toString()},...J])},yr=r=>{const t=i("maxGross")?typeof j(i("maxGross").formula,r)=="number"?j(i("maxGross").formula,r):Number(String(j(i("maxGross").formula,r)).replace(/\./g,"").replace(",",".")):r.maxGross,l=Number(t)||0,x={...r,maxGross:l},_=i("green")?typeof j(i("green").formula,x)=="number"?j(i("green").formula,x):Number(String(j(i("green").formula,x)).replace(/\./g,"").replace(",",".")):r.green,b=i("red")?typeof j(i("red").formula,x)=="number"?j(i("red").formula,x):Number(String(j(i("red").formula,x)).replace(/\./g,"").replace(",",".")):r.red,c=i("delta_number")?typeof j(i("delta_number").formula,x)=="number"?j(i("delta_number").formula,x):Number(String(j(i("delta_number").formula,x)).replace(/\./g,"").replace(",",".")):r.delta_number||0,E=i("delta_percentage")?(()=>{const C=i("delta_percentage");return C.formula&&C.formula.trim()!=="(green + red) / maxGross"?typeof j(C.formula,x)=="number"?j(C.formula,x):Number(String(j(C.formula,x)).replace(/\./g,"").replace(",",".")):l!==0?(r.green+r.red)/l*100:0})():r.delta_percentage||0;return{...r,maxGross:l,green:Number(_)||0,red:Number(b)||0,delta_number:Number(c)||0,delta_percentage:Number(E)||0,delta:0}},_r=r=>{o(r),d(!0)},Cr=r=>{de(J.filter(t=>t.id!==r))},[Z,ke]=u.useState([{id:"main-cost-formula",name:"Max Bruto",formula:"IF(startup, Opstart * exOmw, 0) + netRun + (netRun * Marge) + (c4_4 * exOmw * param_4_4) + (c4_0 * exOmw * param_4_0) + (c1_0 * exOmw * param_1_0) + (c1_1 * exOmw * param_1_1) + (c4_1 * exOmw * param_4_1)",targetColumn:"maxGross"},{id:"delta-number-formula",name:"Delta Number",formula:"green + red - maxGross",targetColumn:"delta_number"},{id:"delta-percentage-formula",name:"Delta Percentage",formula:"(green + red) / maxGross",targetColumn:"delta_percentage"}]),[wr,me]=u.useState(!1),[xe,Te]=u.useState(null),[te,ue]=u.useState(""),[U,Q]=u.useState(""),[Fe,he]=u.useState(void 0),se=[{key:"pages",label:"Pagina's"},{key:"exOmw",label:"ex/omw."},{key:"netRun",label:"Oplage netto"},{key:"startup",label:"Opstart"},{key:"c4_4",label:"4/4"},{key:"c4_0",label:"4/0"},{key:"c1_0",label:"1/0"},{key:"c1_1",label:"1/1"},{key:"c4_1",label:"4/1"},{key:"maxGross",label:"Max Bruto"},{key:"green",label:"Groen"},{key:"red",label:"Rood"},{key:"delta",label:"Delta"}],ae=[{key:"Marge",label:"Marge"},{key:"Opstart",label:"Opstart"},{key:"param_4_4",label:"4/4"},{key:"param_4_0",label:"4/0"},{key:"param_1_0",label:"1/0"},{key:"param_1_1",label:"1/1"},{key:"param_4_1",label:"4/1"}],We=["+","-","*","/","(",")"],pe=r=>{Q(t=>t+" "+r)},j=(r,t)=>{try{if(!r||!r.trim())return"";const l=(C,G,T)=>C?G:T,x=a.length>0?a[0]:"",_=x?O[x]:{};let b=r;const c=C=>C.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");se.forEach(C=>{const G=new RegExp(c(C.key),"g");let T=t[C.key];T===null&&(T=0),C.key==="startup"&&(T=T&&_.opstart||0),b=b.replace(G,String(T))}),ae.forEach(C=>{const G=new RegExp(c(C.key),"g");let T=C.key;C.key==="Marge"&&(T="marge"),C.key==="Opstart"&&(T="opstart");let K=_[T]||0;T==="marge"&&(K=(parseFloat((_.margePercentage||"0").replace(",","."))||0)/100),b=b.replace(G,String(K))});const E=Function("IF",'"use strict"; return ('+b+")")(l);return typeof E=="number"?(Math.round(E*100)/100).toLocaleString("nl-NL",{minimumFractionDigits:0,maximumFractionDigits:2}):E}catch(l){return console.error("Formula evaluation error:",l),""}},$e={pages:{bg:"#dbeafe",text:"#1e40af"},exOmw:{bg:"#cffafe",text:"#0e7490"},netRun:{bg:"#ccfbf1",text:"#0f766e"},startup:{bg:"#d1fae5",text:"#047857"},c4_4:{bg:"#e0e7ff",text:"#4338ca"},c4_0:{bg:"#ede9fe",text:"#6d28d9"},c1_0:{bg:"#f3e8ff",text:"#7c3aed"},c1_1:{bg:"#fae8ff",text:"#a21caf"},c4_1:{bg:"#fce7f3",text:"#be185d"},Marge:{bg:"#dcfce7",text:"#15803d"},Opstart:{bg:"#ecfccb",text:"#4d7c0f"},param_4_4:{bg:"#fef9c3",text:"#a16207"},param_4_0:{bg:"#fef3c7",text:"#b45309"},param_1_0:{bg:"#ffedd5",text:"#c2410c"},param_1_1:{bg:"#fee2e2",text:"#b91c1c"},param_4_1:{bg:"#ffe4e6",text:"#be123c"}},kr=(r,t)=>{if(!r||!r.trim())return null;const l=a.length>0?a[0]:"",x=l?O[l]:{},_=[];return se.forEach(b=>{if(r.includes(b.key)){let c=t[b.key];b.key==="startup"&&(c=c&&x.opstart||0),_.push({key:b.key,label:b.label,value:c,color:$e[b.key]||{bg:"#f3f4f6",text:"#374151"}})}}),ae.forEach(b=>{if(r.includes(b.key)){let c=b.key;b.key==="Marge"&&(c="marge"),b.key==="Opstart"&&(c="opstart");let E=x[c]||0;c==="marge"&&(E=(parseFloat((x.margePercentage||"0").replace(",","."))||0)/100),_.push({key:b.key,label:b.label+" (param)",value:E,color:$e[b.key]||{bg:"#f3f4f6",text:"#374151"}})}}),_},ge=({formula:r,job:t,result:l})=>{const x=kr(r,t);if(!x||x.length===0)return e.jsx("span",{children:l});const _=new Map(x.map(c=>[c.key,c])),b=()=>{const c=x.map(T=>T.key).sort((T,K)=>K.length-T.length),E=T=>T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),C=new RegExp(`(${c.map(E).join("|")})`,"g");return r.split(C).map((T,K)=>{const W=_.get(T);if(W){const Oe=typeof W.value=="number"?M(W.value):W.value;return e.jsx("span",{className:"inline-block px-1 py-0.5 rounded text-xs font-medium mx-0.5",style:{backgroundColor:W.color.bg,color:W.color.text},children:Oe},K)}return e.jsx("span",{style:{color:"#374151"},children:T},K)})};return e.jsxs(Ft,{children:[e.jsx(Ot,{asChild:!0,children:e.jsx("span",{className:"cursor-help border-b border-dashed border-gray-400",children:l})}),e.jsx(St,{side:"top",style:{backgroundColor:"white",color:"#1f2937"},className:"border border-gray-200 shadow-lg max-w-md p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-semibold",style:{color:"#4b5563"},children:"Formule berekening:"}),e.jsx("div",{className:"font-mono text-xs p-2 rounded border flex flex-wrap items-center",style:{backgroundColor:"#f3f4f6",borderColor:"#e5e7eb"},children:b()}),e.jsx("div",{className:"text-xs font-semibold mt-3 mb-1",style:{color:"#4b5563"},children:"Gebruikte waarden:"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:x.map((c,E)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium",style:{backgroundColor:c.color.bg,color:c.color.text},children:[e.jsxs("span",{style:{opacity:.7},children:[c.label,":"]}),e.jsx("span",{className:"font-bold",children:typeof c.value=="number"?M(c.value):c.value})]},E))}),e.jsxs("div",{className:"border-t pt-2 mt-2 flex items-center justify-between",style:{borderColor:"#e5e7eb"},children:[e.jsx("span",{className:"text-xs",style:{color:"#6b7280"},children:"Resultaat:"}),e.jsx("span",{className:"font-bold text-sm",style:{color:"#1f2937"},children:l})]})]})})]})},ne=(r,t)=>{r?(Te(r),ue(r.name),Q(r.formula),he(r.targetColumn)):(Te(null),ue(""),Q(""),he(t)),me(!0)},Tr=()=>{if(!(!te.trim()||!U.trim())){if(xe)ke(Z.map(r=>r.id===xe.id?{...r,name:te,formula:U,targetColumn:Fe}:r));else{const r={id:Date.now().toString(),name:te,formula:U,targetColumn:Fe};ke([...Z,r])}me(!1),ue(""),Q(""),he(void 0),Te(null)}},Fr=r=>{ke(Z.filter(t=>t.id!==r))},Or=J.length>0?j(U,J[0]):"N/A";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(zr,{defaultValue:"werkorders",className:"w-full",children:[e.jsxs(Ur,{className:"flex w-full whitespace-nowrap",children:[e.jsx(Pe,{value:"werkorders",children:"Werkorders"}),e.jsx(Pe,{value:"finished",children:"Finished"}),e.jsx(Pe,{value:"parameters",children:"Parameters"})]}),e.jsx(Re,{value:"werkorders",children:e.jsxs(fe,{children:[e.jsxs(be,{children:[e.jsx(je,{className:"pl-4",children:"Werkorders"}),e.jsx(qr,{children:e.jsxs(S,{onClick:()=>D(p),children:[e.jsx(ve,{className:"w-4 h-4 mr-2"})," Werkorder"]})})]}),e.jsx(Ne,{className:"space-y-4",children:N.map(r=>e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{className:"flex gap-4 w-full items-end",children:[e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx(F,{children:"Order Nr"}),e.jsx(v,{value:`DT ${r.orderNr}`,readOnly:!0,style:{width:"85px"},className:"text-center p-0 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(F,{className:"pl-3",children:"Order"}),e.jsx(v,{value:r.orderName,readOnly:!0,className:"w-full border-0 focus-visible:ring-0 focus-visible:ring-offset-0"})]})]})}),e.jsxs(Ee,{children:[e.jsx(Ge,{children:e.jsxs($,{children:[e.jsx(f,{style:{width:"60px"},children:"Order Date"}),e.jsx(f,{children:"Versie/Katern"}),e.jsx(f,{style:{width:"40px"},className:"text-center",children:"Pagina's"}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:"Ex/Omw."}),e.jsx(f,{style:{width:"100px"},children:"Oplage"}),e.jsx(f,{style:{width:"60px"},children:"Opstart"}),e.jsx(f,{style:{width:"40px"},className:"text-center",children:"4/4"}),e.jsx(f,{style:{width:"40px"},className:"text-center",children:"4/0"}),e.jsx(f,{style:{width:"40px"},className:"text-center",children:"1/0"}),e.jsx(f,{style:{width:"40px"},className:"text-center",children:"1/1"}),e.jsx(f,{style:{width:"40px"},className:"text-center",children:"4/1"}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:"Max Bruto"}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:"Groen"}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:"Rood"}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:"Delta"}),e.jsx(f,{style:{width:"40px"},className:"text-center",children:"Delta %"}),e.jsx(f,{style:{width:"100px"},children:"Actions"})]})}),e.jsx(Me,{children:r.katernen.map(t=>{const l=i("maxGross"),x=l?j(l.formula,t):String(t.maxGross),_=x?parseFloat(x.replace(/\./g,"").replace(",",".")):0,b={...t,maxGross:isNaN(_)?0:_};return e.jsxs($,{children:[e.jsx(g,{children:r.orderDate}),e.jsx(g,{children:e.jsx(v,{value:t.version,onChange:c=>k(r.id,t.id,"version",c.target.value)})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.pages??"",onChange:c=>k(r.id,t.id,"pages",c.target.value),className:"text-right"})}),e.jsx(g,{children:e.jsx(v,{value:t.exOmw,onChange:c=>k(r.id,t.id,"exOmw",c.target.value),className:"w-full text-center px-0 py-0"})}),e.jsx(g,{children:e.jsx(v,{type:"number",value:t.netRun,onChange:c=>k(r.id,t.id,"netRun",c.target.value),className:"text-right"})}),e.jsx(g,{children:e.jsx(ce,{checked:t.startup,onCheckedChange:c=>k(r.id,t.id,"startup",c)})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.c4_4,onChange:c=>k(r.id,t.id,"c4_4",c.target.value),className:"text-center border-none focus-visible:ring-0 focus-visible:ring-offset-0"})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.c4_0,onChange:c=>k(r.id,t.id,"c4_0",c.target.value),className:"text-center border-none focus-visible:ring-0 focus-visible:ring-offset-0"})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.c1_0,onChange:c=>k(r.id,t.id,"c1_0",c.target.value),className:"text-center border-none focus-visible:ring-0 focus-visible:ring-offset-0"})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.c1_1,onChange:c=>k(r.id,t.id,"c1_1",c.target.value),className:"text-center border-none focus-visible:ring-0 focus-visible:ring-offset-0"})}),e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",value:t.c4_1,onChange:c=>k(r.id,t.id,"c4_1",c.target.value),className:"text-center border-none focus-visible:ring-0 focus-visible:ring-offset-0"})}),e.jsx(g,{children:l?e.jsx(ge,{formula:l.formula,job:t,result:x}):M(t.maxGross)}),e.jsx(g,{children:e.jsx(v,{type:"number",value:t.green??"",onChange:c=>k(r.id,t.id,"green",c.target.value)})}),e.jsx(g,{children:e.jsx(v,{type:"number",value:t.red??"",onChange:c=>k(r.id,t.id,"red",c.target.value)})}),e.jsx(g,{children:(()=>{const c=i("delta_number");return c?j(c.formula,b):M(t.delta)})()}),e.jsx(g,{children:(()=>{const c=i("delta_percentage"),E=c?j(c.formula,b):t.deltaPercentage,C=typeof E=="string"?parseFloat(E.replace(/\./g,"").replace(",",".")):E;return isNaN(C)?"0.00%":`${(C*100).toFixed(2)}%`})()}),e.jsx(g,{children:e.jsx(S,{size:"sm",variant:"ghost",className:"hover:bg-red-100 text-red-500",children:e.jsx(De,{className:"w-4 h-4"})})})]},t.id)})})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs(S,{onClick:()=>h(r.id),size:"sm",variant:"ghost",children:[e.jsx(ve,{className:"w-4 h-4 mr-1"})," Add Katern/Versie"]}),e.jsx(S,{onClick:()=>I(r),size:"sm",className:"w-48",children:"Order Opslaan"})]})]},r.id))})]})}),e.jsx(Re,{value:"finished",children:e.jsxs(fe,{children:[e.jsxs(be,{className:"flex flex-row items-center justify-between",children:[e.jsx(je,{children:"Finished Print Jobs"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(ze,{value:we,onValueChange:jr,children:[e.jsx(Ue,{className:"w-[130px]",children:e.jsx(qe,{placeholder:"Filter by"})}),e.jsxs(Ye,{children:[e.jsx(q,{value:"all",children:"All Fields"}),e.jsx(q,{value:"orderNr",children:"Order Nr"}),e.jsx(q,{value:"orderName",children:"Order Name"}),e.jsx(q,{value:"date",children:"Date"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Qr,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(v,{placeholder:"Search...",className:"pl-8 w-[200px]",value:Ce,onChange:r=>br(r.target.value)})]}),e.jsxs(S,{onClick:()=>{o(null),d(!0)},children:[e.jsx(ve,{className:"w-4 h-4 mr-2"}),"Add Finished Job"]})]})]}),e.jsx(Ne,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ee,{className:"table-fixed w-full",children:[e.jsxs(Ge,{children:[e.jsxs($,{children:[e.jsx(f,{colSpan:6,className:"text-center bg-blue-100",style:{borderRight:"1px solid black"},children:"Data"}),e.jsx(f,{colSpan:6,className:"text-center bg-green-100",style:{borderTop:"1px solid black",borderRight:"1px solid black"},children:"Wissels"}),e.jsx(f,{colSpan:3,className:"text-center bg-yellow-100",style:{borderTop:"1px solid black",borderRight:"1px solid black"},children:"Berekening"}),e.jsx(f,{colSpan:2,className:"text-center bg-purple-100",style:{borderTop:"1px solid black",borderRight:"1px solid black"},children:"Prestatie"}),e.jsx(f,{className:"w-[100px]"})]}),e.jsxs($,{children:[e.jsx(f,{onClick:()=>L("date"),style:{width:"83px"},className:"cursor-pointer hover:bg-gray-100 border-r",children:e.jsxs("div",{className:"flex items-center",children:["Date ",A("date")]})}),e.jsx(f,{onClick:()=>L("orderNr"),style:{width:"65px"},className:"cursor-pointer hover:bg-gray-100 border-r",children:e.jsxs("div",{className:"flex items-center",children:["Order nr ",A("orderNr")]})}),e.jsx(f,{onClick:()=>L("orderName"),className:"cursor-pointer hover:bg-gray-100 min-w-[150px] border-r",children:e.jsxs("div",{className:"flex items-center",children:["Order ",A("orderName")]})}),e.jsx(f,{onClick:()=>L("pages"),className:"cursor-pointer hover:bg-gray-100 text-center border-r",children:e.jsxs("div",{className:"flex items-center justify-center",children:["Blz ",A("pages")]})}),e.jsx(f,{onClick:()=>L("exOmw"),className:"cursor-pointer hover:bg-gray-100 text-center leading-3 border-r",children:e.jsxs("div",{className:"flex items-center justify-center h-full",children:["Ex/",e.jsx("br",{}),"Omw. ",A("exOmw")]})}),e.jsx(f,{onClick:()=>L("netRun"),className:"cursor-pointer hover:bg-gray-100 text-center border-r",children:e.jsxs("div",{className:"flex items-center justify-center",children:["Oplage netto ",A("netRun")]})}),e.jsx(f,{onClick:()=>L("startup"),className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-center",children:["Opstart ",A("startup")]})}),e.jsx(f,{onClick:()=>L("c4_4"),className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["4/4 ",A("c4_4")]})}),e.jsx(f,{onClick:()=>L("c4_0"),className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["4/0 ",A("c4_0")]})}),e.jsx(f,{onClick:()=>L("c1_0"),className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["1/0 ",A("c1_0")]})}),e.jsx(f,{onClick:()=>L("c1_1"),className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["1/1 ",A("c1_1")]})}),e.jsx(f,{onClick:()=>L("c4_1"),className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black border-r",children:e.jsxs("div",{className:"flex items-center justify-center",children:["4/1 ",A("c4_1")]})}),e.jsx(f,{style:{width:"90px"},className:"text-center border-r",children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(S,{variant:"ghost",className:"h-auto p-0 font-bold hover:bg-transparent hover:text-blue-600 truncate max-w-[60px]",onClick:()=>ne(i("maxGross"),"maxGross"),title:i("maxGross")?.name||"Max Bruto",children:i("maxGross")?.name||"Max Bruto"}),e.jsx("div",{onClick:()=>L("maxGross"),className:"cursor-pointer p-1 hover:bg-gray-200 rounded shrink-0",children:A("maxGross")})]})}),e.jsx(f,{style:{width:"90px"},className:"text-center border-r",children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(S,{variant:"ghost",className:"h-auto p-0 font-bold hover:bg-transparent hover:text-blue-600 truncate max-w-[60px]",onClick:()=>ne(i("green"),"green"),title:i("green")?.name||"Groen",children:i("green")?.name||"Groen"}),e.jsx("div",{onClick:()=>L("green"),className:"cursor-pointer p-1 hover:bg-gray-200 rounded shrink-0",children:A("green")})]})}),e.jsx(f,{style:{width:"90px",borderRight:"1px solid black"},className:"text-center",children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(S,{variant:"ghost",className:"h-auto p-0 font-bold hover:bg-transparent hover:text-blue-600 truncate max-w-[60px]",onClick:()=>ne(i("red"),"red"),title:i("red")?.name||"Rood",children:i("red")?.name||"Rood"}),e.jsx("div",{onClick:()=>L("red"),className:"cursor-pointer p-1 hover:bg-gray-200 rounded shrink-0",children:A("red")})]})}),e.jsx(f,{className:"text-center border-r",children:e.jsx("div",{className:"flex items-center gap-1 justify-center",children:e.jsx("span",{className:"font-bold",children:"Delta"})})}),e.jsx(f,{className:"text-center border-r",children:e.jsx("div",{className:"flex items-center gap-1 justify-center",children:e.jsx("span",{className:"font-bold",children:"Delta %"})})}),e.jsx(f,{style:{width:"100px"},className:"text-center",children:e.jsx("div",{className:"flex items-center gap-1 justify-center",children:e.jsx("span",{className:"font-bold",children:"Acties"})})})]})]}),e.jsx(Me,{children:Nr.map(r=>e.jsxs($,{children:[e.jsx(g,{children:r.date}),e.jsxs(g,{children:["DT ",r.orderNr]}),e.jsx(g,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:r.orderName}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mt-0.5",children:[e.jsx("span",{className:"w-3 h-3 border-l border-b border-gray-300 mr-1 rounded-bl-sm inline-block"}),r.version]})]})}),e.jsxs(g,{className:"w-full text-center p-0",children:[M(r.pages)," blz"]}),e.jsx(g,{className:"w-full text-center p-0",children:r.exOmw}),e.jsx(g,{className:"w-full text-center p-0 border-r",children:M(r.netRun)}),e.jsx(g,{className:"w-full text-center p-0 bg-gray-50",children:e.jsx("div",{className:"flex justify-center",children:r.startup?e.jsx(Yr,{className:"w-4 h-4 text-green-600"}):e.jsx("span",{className:"text-gray-300",children:"-"})})}),"                                                ",e.jsx(g,{className:"w-full text-center p-0 bg-gray-50",children:M(r.c4_4)}),e.jsx(g,{className:"w-full text-center p-0 bg-gray-50",children:M(r.c4_0)}),e.jsx(g,{className:"w-full text-center p-0 bg-gray-50",children:M(r.c1_0)}),e.jsx(g,{className:"w-full text-center p-0 bg-gray-50",children:M(r.c1_1)}),e.jsx(g,{className:"w-full text-center p-0 bg-gray-50 border-r",children:M(r.c4_1)}),e.jsx(g,{className:"p-0 text-center",children:(()=>{const t=i("maxGross");return t?e.jsx(ge,{formula:t.formula,job:r,result:j(t.formula,r)}):M(r.maxGross)})()}),e.jsx(g,{className:"p-0 text-center",children:(()=>{const t=i("green");return t?e.jsx(ge,{formula:t.formula,job:r,result:j(t.formula,r)}):M(r.green)})()}),e.jsx(g,{className:"p-0 text-center",style:{borderRight:"1px solid black"},children:(()=>{const t=i("red");return t?e.jsx(ge,{formula:t.formula,job:r,result:j(t.formula,r)}):M(r.red)})()}),e.jsx(g,{className:"w-full text-center p-0",children:(()=>{const t=i("delta_number");return M(t?j(t.formula,r):r.delta_number)})()}),e.jsx(g,{className:"w-full text-center p-0 border-r",children:(()=>{const t=i("delta_percentage"),l=t?j(t.formula,r):M(r.delta_percentage),x=typeof l=="string"?parseFloat(l.replace(/\./g,"").replace(",","."))*100:l*100,_=Math.round(x*100)/100;return _+"%"})()}),e.jsx(g,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{size:"sm",variant:"ghost",className:"hover:bg-blue-100 text-blue-600",onClick:()=>_r(r),children:e.jsx(Xe,{className:"w-4 h-4"})}),e.jsx(S,{size:"sm",variant:"ghost",className:"hover:bg-red-100 text-red-500",onClick:()=>Cr(r.id),children:e.jsx(De,{className:"w-4 h-4"})})]})})]},r.id))})]})})})]})}),e.jsx(Re,{value:"parameters",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(fe,{children:[e.jsx(be,{children:e.jsx(je,{children:"Parameters"})}),e.jsxs(Ne,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ee,{children:[e.jsx(Ge,{children:e.jsxs($,{children:[e.jsx(f,{className:"w-[200px]",children:"Parameter"}),e.jsx(f,{className:"w-[50px] text-center",children:"Link"}),a.map(r=>e.jsx(f,{className:"text-center min-w-[120px]",children:r},r))]})}),e.jsxs(Me,{children:[e.jsxs($,{children:[e.jsx(g,{className:"font-medium",children:"Marge"}),e.jsx(g,{className:"text-center",children:e.jsx(ce,{checked:V.margePercentage,onCheckedChange:()=>X("margePercentage")})}),a.map(r=>e.jsx(g,{children:e.jsx("div",{className:"flex gap-2",children:e.jsx(v,{type:"text",placeholder:"%",className:"h-8",value:O[r]?.margePercentage||"",onChange:t=>H(r,"margePercentage",t.target.value)})})},r))]}),e.jsxs($,{children:[e.jsx(g,{className:"font-medium",children:"Opstart"}),e.jsx(g,{className:"text-center",children:e.jsx(ce,{checked:V.opstart,onCheckedChange:()=>X("opstart")})}),a.map(r=>e.jsx(g,{className:"text-center",children:e.jsx(v,{type:"number",className:"h-8",value:O[r]?.opstart||0,onChange:t=>H(r,"opstart",Number(t.target.value))})},r))]}),[{id:"param_4_4",label:"4/4"},{id:"param_4_0",label:"4/0"},{id:"param_1_0",label:"1/0"},{id:"param_1_1",label:"1/1"},{id:"param_4_1",label:"4/1"}].map(r=>e.jsxs($,{children:[e.jsx(g,{className:"font-medium",children:r.label}),e.jsx(g,{className:"text-center",children:e.jsx(ce,{checked:V[r.id],onCheckedChange:()=>X(r.id)})}),a.map(t=>e.jsx(g,{children:e.jsx(v,{type:"number",className:"h-8",value:O[t]?.[r.id]||0,onChange:l=>H(t,r.id,Number(l.target.value))})},t))]},r.id))]})]})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(S,{children:"Save Changes"})})]})]}),e.jsxs(fe,{children:[e.jsxs(be,{className:"flex flex-row items-center justify-between",children:[e.jsx(je,{children:"Calculated Fields"}),e.jsxs(S,{onClick:()=>ne(),className:"gap-2",children:[e.jsx(ve,{className:"w-4 h-4"}),"Add Formula"]})]}),e.jsx(Ne,{children:Z.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:'No calculated fields yet. Click "Add Formula" to create one.'}):e.jsx("div",{className:"space-y-2",children:Z.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:r.name}),e.jsx("div",{className:"text-sm text-gray-600 font-mono",children:r.formula}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Preview: ",j(r.formula,J[0])]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>ne(r),children:e.jsx(Xe,{className:"w-4 h-4"})}),e.jsx(S,{variant:"ghost",size:"sm",onClick:()=>Fr(r.id),children:e.jsx(De,{className:"w-4 h-4 text-red-500"})})]})]},r.id))})})]})]})})]}),e.jsx(Pt,{open:n,onOpenChange:d,onSubmit:vr,editJob:m}),e.jsx(tr,{open:wr,onOpenChange:me,children:e.jsxs(sr,{className:"max-w-2xl",children:[e.jsxs(ar,{children:[e.jsxs(nr,{className:"flex items-center gap-2",children:[e.jsx(st,{className:"w-5 h-5"}),xe?"Edit Formula":"Create Calculated Field"]}),e.jsx(lr,{children:"Build a formula by clicking on fields, operators, and numbers below."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{htmlFor:"formula-name",children:"Field Name *"}),e.jsx(v,{id:"formula-name",placeholder:"e.g., Total Cost",value:te,onChange:r=>ue(r.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{children:"Target Column (Optional)"}),e.jsxs(ze,{value:Fe||"none",onValueChange:r=>he(r==="none"?void 0:r),children:[e.jsx(Ue,{children:e.jsx(qe,{placeholder:"Select a column to display this formula"})}),e.jsxs(Ye,{children:[e.jsx(q,{value:"none",children:"None (Reference only)"}),e.jsx(q,{value:"maxGross",children:"Max Bruto"}),e.jsx(q,{value:"delta_number",children:"Delta Number"}),e.jsx(q,{value:"delta_percentage",children:"Delta Percentage"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(F,{children:"Formula"}),e.jsx(v,{value:U,onChange:r=>Q(r.target.value),placeholder:"Type or click fields below to build formula...",className:"font-mono"}),e.jsx("div",{className:"p-3 border rounded-md bg-gray-50 min-h-[60px] flex flex-wrap gap-2 items-center",children:U?U.split(" ").filter(r=>r).map((r,t)=>{const l=se.some(b=>b.key===r)||ae.some(b=>b.key===r),x=We.includes(r),_=!isNaN(Number(r))&&r!=="";if(l){const b=se.find(c=>c.key===r)||ae.find(c=>c.key===r);return e.jsx(Le,{variant:"outline",className:"bg-blue-50 border-blue-200",children:b?.label||r},t)}else return x?e.jsx("span",{className:"px-2 py-1 bg-gray-200 rounded font-mono text-sm",children:r},t):_?e.jsx("span",{className:"px-2 py-1 bg-green-50 border border-green-200 rounded font-mono text-sm",children:r},t):e.jsx("span",{className:"font-mono text-sm",children:r},t)}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Formula will appear here..."})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(S,{variant:"outline",size:"sm",onClick:()=>Q(""),children:"Clear"}),e.jsx(S,{variant:"outline",size:"sm",onClick:()=>Q(r=>r.trim().split(" ").slice(0,-1).join(" ")),children:"Remove Last"})]})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{children:[e.jsx(F,{className:"text-xs text-gray-600",children:"Finished Job Fields"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:se.map(r=>e.jsx(Le,{variant:"outline",className:"cursor-pointer hover:bg-blue-100",onClick:()=>pe(r.key),children:r.label},r.key))})]}),e.jsxs("div",{children:[e.jsx(F,{className:"text-xs text-gray-600",children:"Parameters"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:ae.map(r=>e.jsx(Le,{variant:"outline",className:"cursor-pointer hover:bg-green-100",onClick:()=>pe(r.key),children:r.label},r.key))})]}),e.jsxs("div",{children:[e.jsx(F,{className:"text-xs text-gray-600",children:"Operators"}),e.jsx("div",{className:"flex gap-2 mt-2",children:We.map(r=>e.jsx(S,{variant:"outline",size:"sm",onClick:()=>pe(r),className:"w-10",children:r},r))})]}),e.jsxs("div",{children:[e.jsx(F,{className:"text-xs text-gray-600",children:"Number"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(v,{type:"number",placeholder:"Enter number",className:"w-32",onKeyDown:r=>{r.key==="Enter"&&(pe(r.target.value),r.target.value="")}}),e.jsx("span",{className:"text-xs text-gray-500 self-center",children:"Press Enter to add"})]})]})]}),e.jsxs("div",{className:"p-3 border rounded-md bg-blue-50",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Preview Result"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-1",children:Or}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Using first job data with sample parameter values"})]})]}),e.jsxs(cr,{children:[e.jsx(S,{variant:"outline",onClick:()=>me(!1),children:"Cancel"}),e.jsx(S,{onClick:Tr,disabled:!te.trim()||!U.trim(),children:xe?"Update Formula":"Save Formula"})]})]})})]})}export{It as Drukwerken};
