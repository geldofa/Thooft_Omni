import{r as l,j as e,J as he,M as ue,N as z,O as xe,Q as Z,R as V,U as me,V as pe,a as fe,W as je,u as ge,B as w,L as R,S as $,k as X,l as G,m as K,n as T,X as Q,T as ve,D as be,b as Ce,d as ke,e as ye,f as Ne,o as Se,t as A}from"./index-BOSUJfQ5.js";import{T as we,a as De,b as L,c as D,d as Oe,e as E}from"./table-w8RrAmTX.js";import{B as H}from"./badge-DQ6TbN8k.js";import{S as Ae,A as Ee,a as Pe,b as Ie,c as Re,d as Te,e as _e,f as Fe,g as Me,h as Be}from"./alert-dialog-CVK_Kxxc.js";import{S as W}from"./switch-BoDVicen.js";import{P as Ue}from"./plus-PDbYzI3A.js";var F="Checkbox",[Le]=he(F),[He,J]=Le(F);function qe(a){const{__scopeCheckbox:x,checked:m,children:j,defaultChecked:o,disabled:n,form:b,name:g,onCheckedChange:i,required:v,value:r="on",internal_do_not_use_render:d}=a,[p,N]=xe({prop:m,defaultProp:o??!1,onChange:i,caller:F}),[f,k]=l.useState(null),[c,h]=l.useState(null),u=l.useRef(!1),O=f?!!b||!!f.closest("form"):!0,S={checked:p,disabled:n,setChecked:N,control:f,setControl:k,name:g,form:b,value:r,hasConsumerStoppedPropagationRef:u,required:v,defaultChecked:y(o)?!1:o,isFormControl:O,bubbleInput:c,setBubbleInput:h};return e.jsx(He,{scope:x,...S,children:ze(d)?d(S):j})}var ee="CheckboxTrigger",se=l.forwardRef(({__scopeCheckbox:a,onKeyDown:x,onClick:m,...j},o)=>{const{control:n,value:b,disabled:g,checked:i,required:v,setControl:r,setChecked:d,hasConsumerStoppedPropagationRef:p,isFormControl:N,bubbleInput:f}=J(ee,a),k=Z(o,r),c=l.useRef(i);return l.useEffect(()=>{const h=n?.form;if(h){const u=()=>d(c.current);return h.addEventListener("reset",u),()=>h.removeEventListener("reset",u)}},[n,d]),e.jsx(z.button,{type:"button",role:"checkbox","aria-checked":y(i)?"mixed":i,"aria-required":v,"data-state":ce(i),"data-disabled":g?"":void 0,disabled:g,value:b,...j,ref:k,onKeyDown:V(x,h=>{h.key==="Enter"&&h.preventDefault()}),onClick:V(m,h=>{d(u=>y(u)?!0:!u),f&&N&&(p.current=h.isPropagationStopped(),p.current||h.stopPropagation())})})});se.displayName=ee;var te=l.forwardRef((a,x)=>{const{__scopeCheckbox:m,name:j,checked:o,defaultChecked:n,required:b,disabled:g,value:i,onCheckedChange:v,form:r,...d}=a;return e.jsx(qe,{__scopeCheckbox:m,checked:o,defaultChecked:n,disabled:g,required:b,onCheckedChange:v,name:j,form:r,value:i,internal_do_not_use_render:({isFormControl:p})=>e.jsxs(e.Fragment,{children:[e.jsx(se,{...d,ref:x,__scopeCheckbox:m}),p&&e.jsx(ie,{__scopeCheckbox:m})]})})});te.displayName=F;var ae="CheckboxIndicator",ne=l.forwardRef((a,x)=>{const{__scopeCheckbox:m,forceMount:j,...o}=a,n=J(ae,m);return e.jsx(ue,{present:j||y(n.checked)||n.checked===!0,children:e.jsx(z.span,{"data-state":ce(n.checked),"data-disabled":n.disabled?"":void 0,...o,ref:x,style:{pointerEvents:"none",...a.style}})})});ne.displayName=ae;var re="CheckboxBubbleInput",ie=l.forwardRef(({__scopeCheckbox:a,...x},m)=>{const{control:j,hasConsumerStoppedPropagationRef:o,checked:n,defaultChecked:b,required:g,disabled:i,name:v,value:r,form:d,bubbleInput:p,setBubbleInput:N}=J(re,a),f=Z(m,N),k=me(n),c=pe(j);l.useEffect(()=>{const u=p;if(!u)return;const O=window.HTMLInputElement.prototype,P=Object.getOwnPropertyDescriptor(O,"checked").set,M=!o.current;if(k!==n&&P){const _=new Event("click",{bubbles:M});u.indeterminate=y(n),P.call(u,y(n)?!1:n),u.dispatchEvent(_)}},[p,k,n,o]);const h=l.useRef(y(n)?!1:n);return e.jsx(z.input,{type:"checkbox","aria-hidden":!0,defaultChecked:b??h.current,required:g,disabled:i,name:v,value:r,form:d,...x,tabIndex:-1,ref:f,style:{...x.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});ie.displayName=re;function ze(a){return typeof a=="function"}function y(a){return a==="indeterminate"}function ce(a){return y(a)?"indeterminate":a?"checked":"unchecked"}function Y({className:a,...x}){return e.jsx(te,{"data-slot":"checkbox",className:fe("peer border bg-input-background dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",a),...x,children:e.jsx(ne,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(je,{className:"size-3.5"})})})}const q=["Lithoman","C80","C818"];function Qe(){const{operators:a,addOperator:x,updateOperator:m,deleteOperator:j,addActivityLog:o,user:n}=ge(),[b,g]=l.useState(!1),[i,v]=l.useState(null),[r,d]=l.useState({name:"",presses:[],active:!0}),[p,N]=l.useState("all"),[f,k]=l.useState("all"),[c,h]=l.useState(!1),[u,O]=l.useState([]);useEffect(()=>{c&&O(a)},[c,a]);const S=(s,t,C)=>{O(U=>U.map(I=>I.id===s?{...I,[t]:C}:I))},P=a.filter(s=>{const t=p==="all"||s.presses.includes(p),C=f==="all"||f==="active"&&s.active||f==="inactive"&&!s.active;return t&&C}),M=()=>{u.forEach(s=>{const t=a.find(C=>C.id===s.id);t&&JSON.stringify(t)!==JSON.stringify(s)&&m(s)}),A.success("Changes saved successfully"),h(!1)},_=s=>{s?(v(s),d({name:s.name,presses:s.presses,active:s.active})):(v(null),d({name:"",presses:[],active:!0}),g(!0))},B=()=>{g(!1),v(null),d({name:"",presses:[],active:!0})},le=s=>{d(t=>({...t,presses:t.presses.includes(s)?t.presses.filter(C=>C!==s):[...t.presses,s]}))},de=s=>{if(s.preventDefault(),!r.name.trim()){A.error("Please enter operator name");return}if(r.presses.length===0){A.error("Please select at least one press");return}if(i){const t={...i,...r};m(t),A.success("Operator updated successfully"),o({user:n?.username||"Unknown",action:"Updated",entity:"Operator",entityId:i.id,entityName:r.name,details:`Updated operator presses: ${r.presses.join(", ")}`})}else{const t={...r,id:Date.now().toString()};x({...r,canEditTasks:!1,canAccessOperatorManagement:!1}),A.success("Operator added successfully"),o({user:n?.username||"Unknown",action:"Created",entity:"Operator",entityId:t.id,entityName:r.name,details:`Added new operator with presses: ${r.presses.join(", ")}`})}B()},oe=(s,t)=>{j(s),A.success(`Operator "${t}" deleted successfully`),o({user:n?.username||"Unknown",action:"Deleted",entity:"Operator",entityId:s,entityName:t,details:"Deleted operator"})};return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-gray-900",children:"Operator Management"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage operators who can perform maintenance tasks"})]}),e.jsxs("div",{className:"flex gap-2",children:[c&&e.jsx(w,{onClick:M,children:"Save Changes"}),e.jsx(w,{onClick:()=>h(!c),variant:"outline",children:c?"Cancel":"Edit Mode"}),e.jsxs(w,{onClick:()=>_(),className:"gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add Operator"]})]})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{children:"Press"}),e.jsxs($,{value:p,onValueChange:s=>N(s),children:[e.jsx(X,{className:"w-[180px]",children:e.jsx(G,{placeholder:"Filter by press"})}),e.jsxs(K,{children:[e.jsx(T,{value:"all",children:"All Presses"}),q.map(s=>e.jsx(T,{value:s,children:s},s))]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(R,{children:"Status"}),e.jsxs($,{value:f,onValueChange:s=>k(s),children:[e.jsx(X,{className:"w-[180px]",children:e.jsx(G,{placeholder:"Filter by status"})}),e.jsxs(K,{children:[e.jsx(T,{value:"all",children:"All"}),e.jsx(T,{value:"active",children:"Active"}),e.jsx(T,{value:"inactive",children:"Inactive"})]})]})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:e.jsxs(we,{children:[e.jsx(De,{children:e.jsxs(L,{children:[e.jsx(D,{children:"ID"}),e.jsx(D,{children:"Name"}),e.jsx(D,{children:"Lithoman"}),e.jsx(D,{children:"C80"}),e.jsx(D,{children:"C818"}),e.jsx(D,{children:"Status"}),!c&&e.jsx(D,{className:"text-right",children:"Actions"})]})}),e.jsx(Oe,{children:P.length===0?e.jsx(L,{children:e.jsx(E,{colSpan:c?6:7,className:"text-center py-12 text-gray-500",children:"No operators found for the selected filters."})}):(c?u:P).map(s=>e.jsxs(L,{children:[e.jsx(E,{children:s.id}),e.jsx(E,{children:c?e.jsx(Q,{value:s.name,onChange:t=>S(s.id,"name",t.target.value)}):s.name}),q.map(t=>e.jsx(E,{children:e.jsx("div",{className:"flex justify-center",children:c?e.jsx(Y,{checked:s.presses.includes(t),onCheckedChange:C=>{const U=C?[...s.presses,t]:s.presses.filter(I=>I!==t);S(s.id,"presses",U)}}):s.presses.includes(t)?e.jsx(H,{variant:"default",className:"bg-green-500",children:"✓"}):e.jsx("span",{className:"text-gray-300",children:"—"})})},t)),e.jsx(E,{children:c?e.jsx(W,{checked:s.active,onCheckedChange:t=>S(s.id,"active",t)}):s.active?e.jsx(H,{variant:"default",children:"Active"}):e.jsx(H,{variant:"secondary",children:"Inactive"})}),!c&&e.jsx(E,{className:"text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>_(s),children:e.jsx(Ae,{className:"w-4 h-4"})}),e.jsxs(Ee,{children:[e.jsx(Pe,{asChild:!0,children:e.jsx(w,{variant:"ghost",size:"sm",children:e.jsx(ve,{className:"w-4 h-4 text-red-500"})})}),e.jsxs(Ie,{children:[e.jsxs(Re,{children:[e.jsx(Te,{children:"Delete Operator"}),e.jsxs(_e,{children:['Are you sure you want to delete "',s.name,'"? This action cannot be undone.']})]}),e.jsxs(Fe,{children:[e.jsx(Me,{children:"Cancel"}),e.jsx(Be,{onClick:()=>oe(s.id,s.name),className:"bg-red-500 hover:bg-red-600",children:"Delete"})]})]})]})]})})]},s.id))})]})}),e.jsx(be,{open:b||!!i,onOpenChange:B,children:e.jsxs(Ce,{className:"max-w-md",children:[e.jsxs(ke,{children:[e.jsx(ye,{children:i?"Edit Operator":"Add New Operator"}),e.jsx(Ne,{children:i?"Update the operator details below.":"Fill in the details for the new operator."})]}),e.jsxs("form",{onSubmit:de,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(R,{htmlFor:"name",children:"Name *"}),e.jsx(Q,{id:"name",placeholder:"e.g., John Smith",value:r.name,onChange:s=>d({...r,name:s.target.value})})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsx(R,{children:"Available Presses *"}),e.jsx("div",{className:"space-y-2",children:q.map(s=>e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Y,{id:s,checked:r.presses.includes(s),onCheckedChange:()=>le(s)}),e.jsx("label",{htmlFor:s,className:"text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70 cursor-pointer",children:s})]},s))})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(R,{htmlFor:"active",children:"Active Status"}),e.jsx("p",{className:"text-gray-500",children:"Inactive operators won't appear in assignment lists"})]}),e.jsx(W,{id:"active",checked:r.active,onCheckedChange:s=>d({...r,active:s})})]})]}),e.jsxs(Se,{children:[e.jsx(w,{type:"button",variant:"outline",onClick:B,children:"Cancel"}),e.jsx(w,{type:"submit",children:i?"Update Operator":"Add Operator"})]})]})]})})]})}export{Qe as OperatorManagement};
