import{u as $,r as u,j as e,B as E,ab as P,z as D,A as S,E as c}from"./index-BLdvJl3a.js";import{B as g}from"./badge-DgA3EjQI.js";function z({tasks:b}){const{presses:M}=$(),[h,O]=u.useState("all"),[l,R]=u.useState("all"),A=u.useRef(null),C=[{label:"Task",w:"w-[40%]",key:"task"},{label:"Due",w:"w-[10%]",key:"due"},{label:"Status",w:"w-[10%]",key:"status"},{label:"Assigned",w:"w-[10%]",key:"assigned"},{label:"Opmerkingen",w:"w-[30%]",key:"opmerkingen"}],p="bg-gray-100 !h-auto p-1 rounded-xl gap-1 border border-transparent inline-flex items-center",o=`
    rounded-lg px-4 py-2 gap-2 font-medium transition-all duration-200 ease-in-out
    !h-auto
    !text-gray-500
    hover:!text-black hover:!bg-gray-200
    active:scale-95
    data-[state=active]:!bg-white
    data-[state=active]:!text-black
    data-[state=active]:!shadow-md
  `,y=t=>{if(!t)return"N/A";const s=new Date(t),a=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),n=String(s.getDate()).padStart(2,"0");return`${a}/${r}/${n}`},j=t=>{const s=new Date;s.setHours(0,0,0,0);let a=b.filter(r=>{const n=new Date(r.nextMaintenance);if(n.setHours(0,0,0,0),n>=s)return!1;if(l==="all")return!0;const i=Math.abs(s.getTime()-n.getTime()),m=Math.ceil(i/(1e3*60*60*24));return l==="1m"?m>30:l==="3m"?m>90:l==="1y"?m>365:!0});return t&&(a=a.filter(r=>r.press===t)),a},f=t=>{const s=new Date;s.setHours(0,0,0,0);const a=new Date(s);a.setDate(a.getDate()+7);let r=b.filter(n=>{const i=new Date(n.nextMaintenance);return i.setHours(0,0,0,0),i>=s&&i<=a});return t&&(r=r.filter(n=>n.press===t)),r},v=t=>{const s={};return t.forEach(a=>{const r=a.category||"Uncategorized";s[r]||(s[r]=[]),s[r].push(a)}),s},H=()=>{window.print()},N=M.filter(t=>t.active&&!t.archived),w=h==="all"?N.map(t=>t.name):[h],k=()=>e.jsx("thead",{children:e.jsx("tr",{className:"text-xs text-gray-400 uppercase border-b border-gray-100",children:C.map((t,s)=>e.jsx("th",{className:`py-1 font-medium ${t.w} ${s===0?"pl-2":""}`,children:t.label},t.key))})}),T=({task:t,isOverdue:s})=>{const a=new Date;a.setHours(0,0,0,0);const r=new Date(t.nextMaintenance);r.setHours(0,0,0,0);const n=Math.abs(a.getTime()-r.getTime()),i=Math.ceil(n/(1e3*60*60*24));return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50 transition-colors text-sm",children:[e.jsxs("td",{className:"py-2 pl-2",children:[e.jsx("div",{className:"font-medium text-gray-900",children:t.task}),t.taskSubtext&&e.jsx("div",{className:"text-xs text-gray-500",children:t.taskSubtext})]}),e.jsx("td",{className:"py-2 text-gray-600 whitespace-nowrap",children:y(t.nextMaintenance)}),e.jsxs("td",{className:`py-2 font-medium whitespace-nowrap ${s?"text-red-600":"text-orange-600"}`,children:[i," days ",s?"overdue":"left"]}),e.jsx("td",{className:"py-2 text-gray-600",children:t.assignedTo||"-"}),e.jsx("td",{className:"py-2 text-gray-500 italic truncate pr-2",title:t.opmerkingen,children:t.opmerkingen||"-"})]})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between py-4 no-print",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Maintenance Reports"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Overview of maintenance status"})]}),e.jsxs(E,{onClick:H,className:"gap-2 shadow-sm",children:[e.jsx(P,{className:"w-4 h-4"}),"Print"]})]}),e.jsxs("div",{className:"no-print flex items-center justify-between gap-4 w-full",children:[e.jsx("div",{className:"bg-gray-100 py-1 px-1 rounded-xl gap-1 border border-transparent inline-flex items-center !h-auto",children:e.jsx(D,{value:h,onValueChange:t=>O(t),children:e.jsxs(S,{className:p,children:[e.jsx(c,{value:"all",className:o,children:"All"}),N.map(t=>e.jsx(c,{value:t.name,className:o,children:t.name},t.id))]})})}),e.jsx("div",{className:"bg-gray-100 py-1 px-1 rounded-xl gap-1 border border-transparent inline-flex items-center !h-auto",children:e.jsx(D,{value:l,onValueChange:t=>R(t),children:e.jsxs(S,{className:p,children:[e.jsx(c,{value:"all",className:o,children:"All"}),e.jsx(c,{value:"1m",className:o,children:"> 1 Month"}),e.jsx(c,{value:"3m",className:o,children:"> 3 Months"}),e.jsx(c,{value:"1y",className:o,children:"> 1 Year"})]})})})]}),e.jsxs("div",{ref:A,className:"print-content",children:[e.jsx("style",{children:`
          @media print {
            body * {
              visibility: hidden;
            }
            .print-content, .print-content * {
              visibility: visible;
            }
            .print-content {
              position: absolute;
              left: 0;
              top: 0;
              width: 100%;
            }
            .no-print {
              display: none !important;
            }
            @page {
              size: A4;
              margin: 15mm;
            }
            tr {
              break-inside: avoid;
            }
            thead {
              display: table-header-group;
            }
          }
        `}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm p-8 min-h-screen",children:[e.jsxs("div",{className:"mb-8 border-b pb-4 text-center",children:[e.jsx("h1",{className:"text-2xl font-extrabold text-gray-900 tracking-tight",children:"Maintenance Report"}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:["Generated on ",y(new Date)]}),l!=="all"&&e.jsx("div",{className:"mt-4 inline-block",children:e.jsxs(g,{variant:"outline",className:"text-red-600 border-red-200 bg-red-50",children:["Filter: Overdue > ",l==="1y"?"1 Year":l==="3m"?"3 Months":"1 Month"]})})]}),w.map(t=>{const s=j(t),a=f(t),r=v(s),n=v(a),i=Object.keys(r).sort(),m=Object.keys(n).sort();return s.length===0&&a.length===0?null:e.jsxs("div",{className:"mb-10 break-inside-avoid",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 bg-gray-50 p-2 rounded-lg border border-gray-100",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:t}),e.jsxs("div",{className:"flex gap-2",children:[s.length>0&&e.jsxs(g,{variant:"destructive",className:"font-mono",children:[s.length," Overdue"]}),a.length>0&&e.jsxs(g,{variant:"secondary",className:"bg-orange-100 text-orange-700 hover:bg-orange-200 border-orange-200 font-mono",children:[a.length," Due Soon"]})]})]}),s.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-red-700 font-semibold mb-3 border-b border-red-100 pb-1 text-sm uppercase tracking-wide",children:"Overdue Tasks"}),i.map(d=>e.jsxs("div",{className:"mb-4 pl-2 border-l-2 border-red-100",children:[e.jsx("h4",{className:"font-semibold text-gray-700 mb-2 text-sm",children:d}),e.jsxs("table",{className:"w-full text-left border-collapse table-fixed",children:[e.jsx(k,{}),e.jsx("tbody",{children:r[d].map(x=>e.jsx(T,{task:x,isOverdue:!0},x.id))})]})]},`overdue-${d}`))]}),a.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-orange-700 font-semibold mb-3 border-b border-orange-100 pb-1 text-sm uppercase tracking-wide",children:"Due This Week"}),m.map(d=>e.jsxs("div",{className:"mb-4 pl-2 border-l-2 border-orange-100",children:[e.jsx("h4",{className:"font-semibold text-gray-700 mb-2 text-sm",children:d}),e.jsxs("table",{className:"w-full text-left border-collapse table-fixed",children:[e.jsx(k,{}),e.jsx("tbody",{children:n[d].map(x=>e.jsx(T,{task:x,isOverdue:!1},x.id))})]})]},`soon-${d}`))]})]},t)}),w.every(t=>j(t).length===0&&f(t).length===0)&&e.jsxs("div",{className:"text-center py-12 bg-gray-50 rounded-lg border border-dashed border-gray-200",children:[e.jsx("p",{className:"text-gray-500 font-medium",children:"No tasks found matching your criteria."}),l!=="all"&&e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Try adjusting the overdue filter."})]})]})]})]})}export{z as Reports};
