import{u as b,r as i,j as s,B as t,R as v,D as N,a as D,b as T,d as B,e as U,L as w,I as g,i as k,t as c}from"./index-BLdvJl3a.js";import{T as A,a as E,b as j,c as d,d as R,e as l}from"./table-BiTOq6bB.js";import{B as u}from"./badge-DgA3EjQI.js";function I(){const{user:o,userAccounts:p,changePassword:P,addActivityLog:f}=b(),[a,r]=i.useState(null),[n,h]=i.useState(""),[m,x]=i.useState(""),y=()=>{if(a){if(n.length<6){c.error("Password must be at least 6 characters");return}if(n!==m){c.error("Passwords do not match");return}P(a,n),c.success("Password changed successfully"),f({user:o?.username||"Unknown",action:"Updated",entity:"Password",entityId:a,entityName:a,details:`Changed password for ${a}`}),r(null),h(""),x("")}},C=e=>o?.role==="admin"||o?.username===e;return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{children:[s.jsx("h2",{className:"text-gray-900",children:"Password Management"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Manage passwords for all user accounts"})]}),s.jsx("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm",children:s.jsxs(A,{children:[s.jsx(E,{children:s.jsxs(j,{children:[s.jsx(d,{children:"Username"}),s.jsx(d,{children:"Role"}),s.jsx(d,{children:"Press"}),s.jsx(d,{className:"text-right",children:"Actions"})]})}),s.jsx(R,{children:p.map(e=>s.jsxs(j,{children:[s.jsx(l,{children:e.username}),s.jsx(l,{children:s.jsx(u,{variant:e.role==="admin"?"default":"secondary",children:e.role})}),s.jsx(l,{children:e.press&&s.jsx(u,{variant:"secondary",children:e.press})}),s.jsx(l,{className:"text-right",children:C(e.username)&&s.jsxs(t,{variant:"ghost",size:"sm",onClick:()=>r(e.username),className:"gap-2",children:[s.jsx(v,{className:"w-4 h-4"}),"Change Password"]})})]},e.username))})]})}),s.jsx(N,{open:!!a,onOpenChange:e=>!e&&r(null),children:s.jsxs(D,{className:"max-w-md",children:[s.jsxs(T,{children:[s.jsx(B,{children:"Change Password"}),s.jsxs(U,{children:["Set a new password for ",a]})]}),s.jsxs("div",{className:"grid gap-4 py-4",children:[s.jsxs("div",{className:"grid gap-2",children:[s.jsx(w,{htmlFor:"newPassword",children:"New Password *"}),s.jsx(g,{id:"newPassword",type:"password",placeholder:"Enter new password",value:n,onChange:e=>h(e.target.value)})]}),s.jsxs("div",{className:"grid gap-2",children:[s.jsx(w,{htmlFor:"confirmPassword",children:"Confirm Password *"}),s.jsx(g,{id:"confirmPassword",type:"password",placeholder:"Confirm new password",value:m,onChange:e=>x(e.target.value)})]})]}),s.jsxs(k,{children:[s.jsx(t,{type:"button",variant:"outline",onClick:()=>r(null),children:"Cancel"}),s.jsx(t,{type:"button",onClick:y,children:"Change Password"})]})]})})]})}export{I as PasswordManagement};
