import{c as Je,j as e,r as d,X as Pr,ac as er,ad as Rr,W as Dr,ae as Er,V as rr,af as Gr,Y as Mr,Z as re,ag as tr,ah as Lr,ai as Ar,aj as Ir,ak as Vr,al as Br,a as Jr,D as sr,b as ar,d as nr,e as lr,f as cr,L as C,P as Hr,g as Kr,B as F,C as Wr,h as zr,i as $r,I as y,k as or,t as Pe,A as Ur,E as qr,F as Re,H as De,am as je,an as be,ao as Ne,ap as ve,T as Ee,M as Ue,N as qe,O as Ye,Q as Qe,R as U,J as Yr,aq as Xe}from"./index-DwJ2JKn3.js";import{T as Ge,a as Me,b as W,c as g,d as Le,e as p}from"./table-NCv9cg08.js";import{B as Ae}from"./badge-BDzXmqbp.js";import{C as oe}from"./checkbox-Bxz0wUBN.js";import{P as ye,S as Ze}from"./square-pen-DcOUP0Xm.js";import{S as Qr}from"./search-fXFg_VWD.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xr=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],Zr=Je("arrow-down",Xr);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const et=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],rt=Je("arrow-up",et);/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tt=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],st=Je("calculator",tt),E=(s,a=0)=>{if(s==null||s==="")return"";const n=typeof s=="string"?parseFloat(s):s;return isNaN(n)?"":n.toLocaleString("nl-NL",{minimumFractionDigits:a,maximumFractionDigits:a,useGrouping:!0})};var at=Symbol("radix.slottable");function nt(s){const a=({children:n})=>e.jsx(e.Fragment,{children:n});return a.displayName=`${s}.Slottable`,a.__radixId=at,a}var[_e]=Pr("Tooltip",[er]),we=er(),ir="TooltipProvider",lt=700,Ve="tooltip.open",[ct,He]=_e(ir),dr=s=>{const{__scopeTooltip:a,delayDuration:n=lt,skipDelayDuration:o=300,disableHoverableContent:m=!1,children:c}=s,x=d.useRef(!0),O=d.useRef(!1),j=d.useRef(0);return d.useEffect(()=>{const u=j.current;return()=>window.clearTimeout(u)},[]),e.jsx(ct,{scope:a,isOpenDelayedRef:x,delayDuration:n,onOpen:d.useCallback(()=>{window.clearTimeout(j.current),x.current=!1},[]),onClose:d.useCallback(()=>{window.clearTimeout(j.current),j.current=window.setTimeout(()=>x.current=!0,o)},[o]),isPointerInTransitRef:O,onPointerInTransitChange:d.useCallback(u=>{O.current=u},[]),disableHoverableContent:m,children:c})};dr.displayName=ir;var ie="Tooltip",[ot,de]=_e(ie),mr=s=>{const{__scopeTooltip:a,children:n,open:o,defaultOpen:m,onOpenChange:c,disableHoverableContent:x,delayDuration:O}=s,j=He(ie,s.__scopeTooltip),u=we(a),[v,k]=d.useState(null),S=Rr(),P=d.useRef(0),G=x??j.disableHoverableContent,B=O??j.delayDuration,A=d.useRef(!1),[D,I]=Dr({prop:o,defaultProp:m??!1,onChange:Z=>{Z?(j.onOpen(),document.dispatchEvent(new CustomEvent(Ve))):j.onClose(),c?.(Z)},caller:ie}),i=d.useMemo(()=>D?A.current?"delayed-open":"instant-open":"closed",[D]),J=d.useCallback(()=>{window.clearTimeout(P.current),P.current=0,A.current=!1,I(!0)},[I]),q=d.useCallback(()=>{window.clearTimeout(P.current),P.current=0,I(!1)},[I]),X=d.useCallback(()=>{window.clearTimeout(P.current),P.current=window.setTimeout(()=>{A.current=!0,I(!0),P.current=0},B)},[B,I]);return d.useEffect(()=>()=>{P.current&&(window.clearTimeout(P.current),P.current=0)},[]),e.jsx(Er,{...u,children:e.jsx(ot,{scope:a,contentId:S,open:D,stateAttribute:i,trigger:v,onTriggerChange:k,onTriggerEnter:d.useCallback(()=>{j.isOpenDelayedRef.current?X():J()},[j.isOpenDelayedRef,X,J]),onTriggerLeave:d.useCallback(()=>{G?q():(window.clearTimeout(P.current),P.current=0)},[q,G]),onOpen:J,onClose:q,disableHoverableContent:G,children:n})})};mr.displayName=ie;var Be="TooltipTrigger",ur=d.forwardRef((s,a)=>{const{__scopeTooltip:n,...o}=s,m=de(Be,n),c=He(Be,n),x=we(n),O=d.useRef(null),j=rr(a,O,m.onTriggerChange),u=d.useRef(!1),v=d.useRef(!1),k=d.useCallback(()=>u.current=!1,[]);return d.useEffect(()=>()=>document.removeEventListener("pointerup",k),[k]),e.jsx(Gr,{asChild:!0,...x,children:e.jsx(Mr.button,{"aria-describedby":m.open?m.contentId:void 0,"data-state":m.stateAttribute,...o,ref:j,onPointerMove:re(s.onPointerMove,S=>{S.pointerType!=="touch"&&!v.current&&!c.isPointerInTransitRef.current&&(m.onTriggerEnter(),v.current=!0)}),onPointerLeave:re(s.onPointerLeave,()=>{m.onTriggerLeave(),v.current=!1}),onPointerDown:re(s.onPointerDown,()=>{m.open&&m.onClose(),u.current=!0,document.addEventListener("pointerup",k,{once:!0})}),onFocus:re(s.onFocus,()=>{u.current||m.onOpen()}),onBlur:re(s.onBlur,m.onClose),onClick:re(s.onClick,m.onClose)})})});ur.displayName=Be;var Ke="TooltipPortal",[it,dt]=_e(Ke,{forceMount:void 0}),xr=s=>{const{__scopeTooltip:a,forceMount:n,children:o,container:m}=s,c=de(Ke,a);return e.jsx(it,{scope:a,forceMount:n,children:e.jsx(tr,{present:n||c.open,children:e.jsx(Lr,{asChild:!0,container:m,children:o})})})};xr.displayName=Ke;var te="TooltipContent",hr=d.forwardRef((s,a)=>{const n=dt(te,s.__scopeTooltip),{forceMount:o=n.forceMount,side:m="top",...c}=s,x=de(te,s.__scopeTooltip);return e.jsx(tr,{present:o||x.open,children:x.disableHoverableContent?e.jsx(pr,{side:m,...c,ref:a}):e.jsx(mt,{side:m,...c,ref:a})})}),mt=d.forwardRef((s,a)=>{const n=de(te,s.__scopeTooltip),o=He(te,s.__scopeTooltip),m=d.useRef(null),c=rr(a,m),[x,O]=d.useState(null),{trigger:j,onClose:u}=n,v=m.current,{onPointerInTransitChange:k}=o,S=d.useCallback(()=>{O(null),k(!1)},[k]),P=d.useCallback((G,B)=>{const A=G.currentTarget,D={x:G.clientX,y:G.clientY},I=pt(D,A.getBoundingClientRect()),i=gt(D,I),J=ft(B.getBoundingClientRect()),q=bt([...i,...J]);O(q),k(!0)},[k]);return d.useEffect(()=>()=>S(),[S]),d.useEffect(()=>{if(j&&v){const G=A=>P(A,v),B=A=>P(A,j);return j.addEventListener("pointerleave",G),v.addEventListener("pointerleave",B),()=>{j.removeEventListener("pointerleave",G),v.removeEventListener("pointerleave",B)}}},[j,v,P,S]),d.useEffect(()=>{if(x){const G=B=>{const A=B.target,D={x:B.clientX,y:B.clientY},I=j?.contains(A)||v?.contains(A),i=!jt(D,x);I?S():i&&(S(),u())};return document.addEventListener("pointermove",G),()=>document.removeEventListener("pointermove",G)}},[j,v,x,u,S]),e.jsx(pr,{...s,ref:c})}),[ut,xt]=_e(ie,{isInside:!1}),ht=nt("TooltipContent"),pr=d.forwardRef((s,a)=>{const{__scopeTooltip:n,children:o,"aria-label":m,onEscapeKeyDown:c,onPointerDownOutside:x,...O}=s,j=de(te,n),u=we(n),{onClose:v}=j;return d.useEffect(()=>(document.addEventListener(Ve,v),()=>document.removeEventListener(Ve,v)),[v]),d.useEffect(()=>{if(j.trigger){const k=S=>{S.target?.contains(j.trigger)&&v()};return window.addEventListener("scroll",k,{capture:!0}),()=>window.removeEventListener("scroll",k,{capture:!0})}},[j.trigger,v]),e.jsx(Ir,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:c,onPointerDownOutside:x,onFocusOutside:k=>k.preventDefault(),onDismiss:v,children:e.jsxs(Vr,{"data-state":j.stateAttribute,...u,...O,ref:a,style:{...O.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[e.jsx(ht,{children:o}),e.jsx(ut,{scope:n,isInside:!0,children:e.jsx(Br,{id:j.contentId,role:"tooltip",children:m||o})})]})})});hr.displayName=te;var gr="TooltipArrow",fr=d.forwardRef((s,a)=>{const{__scopeTooltip:n,...o}=s,m=we(n);return xt(gr,n).isInside?null:e.jsx(Ar,{...m,...o,ref:a})});fr.displayName=gr;function pt(s,a){const n=Math.abs(a.top-s.y),o=Math.abs(a.bottom-s.y),m=Math.abs(a.right-s.x),c=Math.abs(a.left-s.x);switch(Math.min(n,o,m,c)){case c:return"left";case m:return"right";case n:return"top";case o:return"bottom";default:throw new Error("unreachable")}}function gt(s,a,n=5){const o=[];switch(a){case"top":o.push({x:s.x-n,y:s.y+n},{x:s.x+n,y:s.y+n});break;case"bottom":o.push({x:s.x-n,y:s.y-n},{x:s.x+n,y:s.y-n});break;case"left":o.push({x:s.x+n,y:s.y-n},{x:s.x+n,y:s.y+n});break;case"right":o.push({x:s.x-n,y:s.y-n},{x:s.x-n,y:s.y+n});break}return o}function ft(s){const{top:a,right:n,bottom:o,left:m}=s;return[{x:m,y:a},{x:n,y:a},{x:n,y:o},{x:m,y:o}]}function jt(s,a){const{x:n,y:o}=s;let m=!1;for(let c=0,x=a.length-1;c<a.length;x=c++){const O=a[c],j=a[x],u=O.x,v=O.y,k=j.x,S=j.y;v>o!=S>o&&n<(k-u)*(o-v)/(S-v)+u&&(m=!m)}return m}function bt(s){const a=s.slice();return a.sort((n,o)=>n.x<o.x?-1:n.x>o.x?1:n.y<o.y?-1:n.y>o.y?1:0),Nt(a)}function Nt(s){if(s.length<=1)return s.slice();const a=[];for(let o=0;o<s.length;o++){const m=s[o];for(;a.length>=2;){const c=a[a.length-1],x=a[a.length-2];if((c.x-x.x)*(m.y-x.y)>=(c.y-x.y)*(m.x-x.x))a.pop();else break}a.push(m)}a.pop();const n=[];for(let o=s.length-1;o>=0;o--){const m=s[o];for(;n.length>=2;){const c=n[n.length-1],x=n[n.length-2];if((c.x-x.x)*(m.y-x.y)>=(c.y-x.y)*(m.x-x.x))n.pop();else break}n.push(m)}return n.pop(),a.length===1&&n.length===1&&a[0].x===n[0].x&&a[0].y===n[0].y?a:a.concat(n)}var vt=dr,yt=mr,_t=ur,wt=xr,Ct=hr,kt=fr;function Tt({delayDuration:s=0,...a}){return e.jsx(vt,{"data-slot":"tooltip-provider",delayDuration:s,...a})}function Ft({...s}){return e.jsx(Tt,{children:e.jsx(yt,{"data-slot":"tooltip",...s})})}function Ot({...s}){return e.jsx(_t,{"data-slot":"tooltip-trigger",...s})}function St({className:s,sideOffset:a=0,children:n,...o}){return e.jsx(wt,{children:e.jsxs(Ct,{"data-slot":"tooltip-content",sideOffset:a,className:Jr("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",s),...o,children:[n,e.jsx(kt,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}const Ie=({value:s,onChange:a,className:n})=>{const[o,m]=d.useState(()=>s!==""?new Intl.NumberFormat("nl-NL").format(Number(s)):""),[c,x]=d.useState(!1);d.useEffect(()=>{c||m(s!==""?new Intl.NumberFormat("nl-NL").format(Number(s)):"")},[s,c]);const O=()=>{x(!0),m(String(s))},j=()=>{x(!1)},u=v=>{const k=v.target.value.replace(/\./g,"").replace(/[^\d]/g,"");m(v.target.value);const S=parseInt(k,10);a(isNaN(S)?0:S)};return e.jsx(y,{value:o,onChange:u,onFocus:O,onBlur:j,className:n,inputMode:"numeric"})};function Pt({open:s,onOpenChange:a,onSubmit:n,editJob:o}){const m={date:new Date().toISOString().split("T")[0],datum:"",orderNr:"",orderName:"",version:"",pages:0,exOmw:"",netRun:0,startup:!1,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:0,red:0,delta:0,delta_number:0,delta_percentage:0,performance:""},[c,x]=d.useState(m);d.useEffect(()=>{s&&x(o?{...o,id:void 0}:m)},[o,s]);const O=u=>{if(u.preventDefault(),!c.orderNr.trim()||!c.orderName.trim()){Pe.error("Please fill out Order Nr and Order Name");return}n(c),a(!1),o?Pe.success("Job updated successfully"):Pe.success("Job added successfully")},j=u=>u?new Date(u).toLocaleDateString("nl-BE",{year:"numeric",month:"short",day:"numeric"}):"Pick a date";return e.jsx(sr,{open:s,onOpenChange:a,children:e.jsxs(ar,{className:"sm:max-w-[600px] max-h-[90vh] overflow-y-auto",children:[e.jsxs(nr,{children:[e.jsx(lr,{children:o?"Edit Finished Job":"Add Finished Job"}),e.jsx(cr,{children:o?"Update the job details below.":"Fill in the details for the new finished job."})]}),e.jsxs("form",{onSubmit:O,children:[e.jsxs("div",{className:"grid gap-4 py-4",children:[e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"date",className:"text-right",children:"Date"}),e.jsxs(Hr,{children:[e.jsx(Kr,{asChild:!0,children:e.jsxs(F,{variant:"outline",className:"col-span-3 justify-start text-left",children:[e.jsx(Wr,{className:"mr-2 h-4 w-4"}),j(c.date)]})}),e.jsx(zr,{className:"w-auto p-0",align:"start",children:e.jsx($r,{mode:"single",selected:new Date(c.date),onSelect:u=>x({...c,date:u?.toISOString().split("T")[0]||""}),initialFocus:!0})})]})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"orderNr",className:"text-right",children:"Order Nr."}),e.jsx(y,{id:"orderNr",value:c.orderNr,onChange:u=>x({...c,orderNr:u.target.value}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"orderName",className:"text-right",children:"Order"}),e.jsx(y,{id:"orderName",value:c.orderName,onChange:u=>x({...c,orderName:u.target.value}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"version",className:"text-right",children:"Version/Katern"}),e.jsx(y,{id:"version",value:c.version,onChange:u=>x({...c,version:u.target.value}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"pages",className:"text-right",children:"Pages"}),e.jsx(y,{id:"pages",type:"number",value:c.pages||"",onChange:u=>x({...c,pages:Number(u.target.value)}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"exOmw",className:"text-right",children:"Ex/Omw."}),e.jsx(y,{id:"exOmw",value:c.exOmw,onChange:u=>x({...c,exOmw:u.target.value}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"netRun",className:"text-right",children:"Oplage Netto"}),e.jsx(Ie,{value:c.netRun||"",onChange:u=>x({...c,netRun:u}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"startup",className:"text-right",children:"Opstart"}),e.jsx("div",{className:"col-span-3 flex items-center",children:e.jsx(oe,{id:"startup",checked:c.startup,onCheckedChange:u=>x({...c,startup:!!u})})})]}),e.jsx("h3",{className:"font-semibold col-span-4 pt-4",children:"Wissels"}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"c4_4",className:"text-right",children:"4/4"}),e.jsx(y,{id:"c4_4",type:"number",value:c.c4_4||"",onChange:u=>x({...c,c4_4:Number(u.target.value)}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"c4_0",className:"text-right",children:"4/0"}),e.jsx(y,{id:"c4_0",type:"number",value:c.c4_0||"",onChange:u=>x({...c,c4_0:Number(u.target.value)}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"c1_0",className:"text-right",children:"1/0"}),e.jsx(y,{id:"c1_0",type:"number",value:c.c1_0||"",onChange:u=>x({...c,c1_0:Number(u.target.value)}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"c1_1",className:"text-right",children:"1/1"}),e.jsx(y,{id:"c1_1",type:"number",value:c.c1_1||"",onChange:u=>x({...c,c1_1:Number(u.target.value)}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"c4_1",className:"text-right",children:"4/1"}),e.jsx(y,{id:"c4_1",type:"number",value:c.c4_1||"",onChange:u=>x({...c,c4_1:Number(u.target.value)}),className:"col-span-3"})]}),e.jsx("h3",{className:"font-semibold col-span-4 pt-4",children:"Resultaten"}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"green",className:"text-right",children:"Groen"}),e.jsx(Ie,{value:c.green||"",onChange:u=>x({...c,green:u}),className:"col-span-3"})]}),e.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[e.jsx(C,{htmlFor:"red",className:"text-right",children:"Rood"}),e.jsx(Ie,{value:c.red||"",onChange:u=>x({...c,red:u}),className:"col-span-3"})]})]}),e.jsxs(or,{children:[e.jsx(F,{type:"button",variant:"outline",onClick:()=>a(!1),children:"Cancel"}),e.jsx(F,{type:"submit",children:o?"Update Job":"Add Job"})]})]})]})})}function It({presses:s}){const a=s.filter(r=>r.active&&!r.archived).map(r=>r.name),[n,o]=d.useState(!1),[m,c]=d.useState(null),[x,O]=d.useState(null),j={orderNr:"",orderName:"New Werkorder",orderDate:new Date().toISOString().split("T")[0]},u={version:"New Version",pages:0,exOmw:"0",netRun:0,startup:!1,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:0,red:0,delta:0,deltaPercentage:0},[v,k]=d.useState([{id:"1",orderNr:"0001",orderName:"Spar 2025-01",orderDate:"2025-01-01",katernen:[{id:"1-1",version:"Nederlands - Katern 1",pages:40,exOmw:"2",netRun:1e5,startup:!0,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:101e3,red:3e3,delta:0,deltaPercentage:0},{id:"1-2",version:"Frans - Katern 1",pages:40,exOmw:"2",netRun:5e4,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:50500,red:1500,delta:0,deltaPercentage:0}]}]),S=r=>{P(u,r)},P=(r,t)=>{k(v.map(l=>{if(l.id===t){const h={...r,id:`${l.id}-${l.katernen.length+1}`};return{...l,katernen:[...l.katernen,h]}}return l}))},G={id:"new-katern-1",version:"New Version 1",pages:0,exOmw:"0",netRun:0,startup:!1,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:0,red:0,delta:0,deltaPercentage:0},B=r=>{const t=Date.now().toString(),l={...G,id:`${t}-1`},h={...r,id:t,katernen:[l]};k([h,...v])},A=r=>{const t=r.katernen.map(l=>{const h=new Date,_=Xe(h,"yyyy-MM-dd"),b=Xe(h,"dd-MM"),N={...l,orderNr:r.orderNr,orderName:r.orderName,date:_,datum:b},V=i("maxGross")?typeof f(i("maxGross").formula,N)=="number"?f(i("maxGross").formula,N):Number(String(f(i("maxGross").formula,N)).replace(/\./g,"").replace(",",".")):l.maxGross,w=Number(V)||0,R={...N,maxGross:w},T=i("green")?typeof f(i("green").formula,R)=="number"?f(i("green").formula,R):Number(String(f(i("green").formula,R)).replace(/\./g,"").replace(",",".")):l.green,H=i("red")?typeof f(i("red").formula,R)=="number"?f(i("red").formula,R):Number(String(f(i("red").formula,R)).replace(/\./g,"").replace(",",".")):l.red,K=i("delta_number")?typeof f(i("delta_number").formula,R)=="number"?f(i("delta_number").formula,R):Number(String(f(i("delta_number").formula,R)).replace(/\./g,"").replace(",",".")):l.delta,Se=i("delta_percentage")?(()=>{const ce=i("delta_percentage");return ce.formula&&ce.formula.trim()!=="(green + red) / maxGross"?typeof f(ce.formula,R)=="number"?f(ce.formula,R):Number(String(f(ce.formula,R)).replace(/\./g,"").replace(",",".")):w!==0?(Number(T)+Number(H))/w*100:0})():l.deltaPercentage;return{id:Date.now().toString()+"-"+l.id,date:_,datum:b,orderNr:r.orderNr,orderName:r.orderName,version:l.version,pages:l.pages,exOmw:l.exOmw,netRun:l.netRun,startup:l.startup,c4_4:l.c4_4,c4_0:l.c4_0,c1_0:l.c1_0,c1_1:l.c1_1,c4_1:l.c4_1,maxGross:w,green:Number(T)||0,red:Number(H)||0,delta_number:Number(K)||0,delta_percentage:Number(Se)||0,delta:Number(K)||0,performance:"100%"}});me(l=>[...t,...l])},[D,I]=d.useState(()=>{const r={};return a.forEach(t=>{r[t]={marge:0,margePercentage:"4,2",opstart:6e3,param_4_4:4e3,param_4_0:3e3,param_1_0:1500,param_1_1:2e3,param_4_1:3500}}),r}),i=r=>ee.find(t=>t.targetColumn===r),[J,q]=d.useState({marge:!1,margePercentage:!1,opstart:!1,param_4_4:!1,param_4_0:!1,param_1_0:!1,param_1_1:!1,param_4_1:!1}),X=(r,t,l)=>{if(J[t]){const h={...D};a.forEach(_=>{h[_]={...h[_],[t]:l}}),I(h)}else I({...D,[r]:{...D[r],[t]:l}})},Z=r=>{const t=!J[r];if(q({...J,[r]:t}),t&&a.length>0){const l=D[a[0]][r],h={...D};a.forEach(_=>{h[_]={...h[_],[r]:l}}),I(h)}},[Y,me]=d.useState([{id:"1",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Nederlands - Katern 1",pages:40,exOmw:"2",netRun:1e5,startup:!0,c4_4:0,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:101e3,red:3e3,delta_number:0,delta_percentage:0,delta:0,performance:"100%"},{id:"2",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Frans - Katern 1",pages:40,exOmw:"2",netRun:5e4,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:50500,red:1500,delta_number:0,delta_percentage:0,delta:0,performance:"100%"},{id:"3",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Nederlands - Katern 2",pages:32,exOmw:"2",netRun:1e5,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:101e3,red:3e3,delta_number:0,delta_percentage:0,delta:0,performance:"100%"},{id:"4",date:"2025-01-01",datum:"01-01",orderNr:"0001",orderName:"Spar 2025-01",version:"Frans - Katern 2",pages:32,exOmw:"2",netRun:5e4,startup:!1,c4_4:1,c4_0:0,c1_0:0,c1_1:0,c4_1:0,maxGross:0,green:50500,red:1500,delta_number:0,delta_percentage:0,delta:0,performance:"100%"}]),[z,jr]=d.useState(null),[Ce,br]=d.useState(""),[ke,Nr]=d.useState("all"),M=r=>{jr(t=>t?.key===r?t.direction==="asc"?{key:r,direction:"desc"}:null:{key:r,direction:"asc"})},L=r=>!z||z.key!==r?null:z.direction==="asc"?e.jsx(rt,{className:"w-4 h-4 ml-1 text-blue-600"}):e.jsx(Zr,{className:"w-4 h-4 ml-1 text-blue-600"}),We=Y.filter(r=>{if(!Ce)return!0;const t=Ce.toLowerCase();return ke==="all"?Object.values(r).some(l=>String(l).toLowerCase().includes(t)):String(r[ke]).toLowerCase().includes(t)}),vr=z?[...We].sort((r,t)=>{const l=r[z.key],h=t[z.key];return l<h?z.direction==="asc"?-1:1:l>h?z.direction==="asc"?1:-1:0}):We,yr=r=>{const t=_r(r);me(m?Y.map(l=>l.id===m.id?{...t,id:l.id}:l):[{...t,id:Date.now().toString()},...Y])},_r=r=>{const t=i("maxGross")?typeof f(i("maxGross").formula,r)=="number"?f(i("maxGross").formula,r):Number(String(f(i("maxGross").formula,r)).replace(/\./g,"").replace(",",".")):r.maxGross,l=Number(t)||0,h={...r,maxGross:l},_=i("green")?typeof f(i("green").formula,h)=="number"?f(i("green").formula,h):Number(String(f(i("green").formula,h)).replace(/\./g,"").replace(",",".")):r.green,b=i("red")?typeof f(i("red").formula,h)=="number"?f(i("red").formula,h):Number(String(f(i("red").formula,h)).replace(/\./g,"").replace(",",".")):r.red,N=i("delta_number")?typeof f(i("delta_number").formula,h)=="number"?f(i("delta_number").formula,h):Number(String(f(i("delta_number").formula,h)).replace(/\./g,"").replace(",",".")):r.delta_number||0,V=i("delta_percentage")?(()=>{const w=i("delta_percentage");return w.formula&&w.formula.trim()!=="(green + red) / maxGross"?typeof f(w.formula,h)=="number"?f(w.formula,h):Number(String(f(w.formula,h)).replace(/\./g,"").replace(",",".")):l!==0?(r.green+r.red)/l*100:0})():r.delta_percentage||0;return{...r,maxGross:l,green:Number(_)||0,red:Number(b)||0,delta_number:Number(N)||0,delta_percentage:Number(V)||0,delta:0}},wr=r=>{c(r),o(!0)},Cr=r=>{me(Y.filter(t=>t.id!==r))},[ee,Te]=d.useState([{id:"main-cost-formula",name:"Max Bruto",formula:"IF(startup, Opstart * exOmw, 0) + netRun + (netRun * Marge) + (c4_4 * exOmw * param_4_4) + (c4_0 * exOmw * param_4_0) + (c1_0 * exOmw * param_1_0) + (c1_1 * exOmw * param_1_1) + (c4_1 * exOmw * param_4_1)",targetColumn:"maxGross"},{id:"delta-number-formula",name:"Delta Number",formula:"green + red - maxGross",targetColumn:"delta_number"},{id:"delta-percentage-formula",name:"Delta Percentage",formula:"(green + red) / maxGross",targetColumn:"delta_percentage"}]),[kr,ue]=d.useState(!1),[xe,Fe]=d.useState(null),[se,he]=d.useState(""),[$,Q]=d.useState(""),[Oe,pe]=d.useState(void 0),ae=[{key:"pages",label:"Pagina's"},{key:"exOmw",label:"ex/omw."},{key:"netRun",label:"Oplage netto"},{key:"startup",label:"Opstart"},{key:"c4_4",label:"4/4"},{key:"c4_0",label:"4/0"},{key:"c1_0",label:"1/0"},{key:"c1_1",label:"1/1"},{key:"c4_1",label:"4/1"},{key:"maxGross",label:"Max Bruto"},{key:"green",label:"Groen"},{key:"red",label:"Rood"},{key:"delta",label:"Delta"}],ne=[{key:"Marge",label:"Marge"},{key:"Opstart",label:"Opstart"},{key:"param_4_4",label:"4/4"},{key:"param_4_0",label:"4/0"},{key:"param_1_0",label:"1/0"},{key:"param_1_1",label:"1/1"},{key:"param_4_1",label:"4/1"}],ze=["+","-","*","/","(",")"],ge=r=>{Q(t=>t+" "+r)},f=(r,t)=>{try{if(!r||!r.trim())return"";const l=(w,R,T)=>w?R:T,h=a.length>0?a[0]:"",_=h?D[h]:{};let b=r;const N=w=>w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");ae.forEach(w=>{const R=new RegExp(N(w.key),"g");let T=t[w.key];w.key==="startup"&&(T=T&&_.opstart||0),b=b.replace(R,String(T))}),ne.forEach(w=>{const R=new RegExp(N(w.key),"g");let T=w.key;w.key==="Marge"&&(T="marge"),w.key==="Opstart"&&(T="opstart");let H=_[T]||0;T==="marge"&&(H=(parseFloat((_.margePercentage||"0").replace(",","."))||0)/100),b=b.replace(R,String(H))});const V=Function("IF",'"use strict"; return ('+b+")")(l);return typeof V=="number"?(Math.round(V*100)/100).toLocaleString("nl-NL",{minimumFractionDigits:0,maximumFractionDigits:2}):V}catch(l){return console.error("Formula evaluation error:",l),""}},$e={pages:{bg:"#dbeafe",text:"#1e40af"},exOmw:{bg:"#cffafe",text:"#0e7490"},netRun:{bg:"#ccfbf1",text:"#0f766e"},startup:{bg:"#d1fae5",text:"#047857"},c4_4:{bg:"#e0e7ff",text:"#4338ca"},c4_0:{bg:"#ede9fe",text:"#6d28d9"},c1_0:{bg:"#f3e8ff",text:"#7c3aed"},c1_1:{bg:"#fae8ff",text:"#a21caf"},c4_1:{bg:"#fce7f3",text:"#be185d"},Marge:{bg:"#dcfce7",text:"#15803d"},Opstart:{bg:"#ecfccb",text:"#4d7c0f"},param_4_4:{bg:"#fef9c3",text:"#a16207"},param_4_0:{bg:"#fef3c7",text:"#b45309"},param_1_0:{bg:"#ffedd5",text:"#c2410c"},param_1_1:{bg:"#fee2e2",text:"#b91c1c"},param_4_1:{bg:"#ffe4e6",text:"#be123c"}},Tr=(r,t)=>{if(!r||!r.trim())return null;const l=a.length>0?a[0]:"",h=l?D[l]:{},_=[];return ae.forEach(b=>{if(r.includes(b.key)){let N=t[b.key];b.key==="startup"&&(N=N&&h.opstart||0),_.push({key:b.key,label:b.label,value:N,color:$e[b.key]||{bg:"#f3f4f6",text:"#374151"}})}}),ne.forEach(b=>{if(r.includes(b.key)){let N=b.key;b.key==="Marge"&&(N="marge"),b.key==="Opstart"&&(N="opstart");let V=h[N]||0;N==="marge"&&(V=(parseFloat((h.margePercentage||"0").replace(",","."))||0)/100),_.push({key:b.key,label:b.label+" (param)",value:V,color:$e[b.key]||{bg:"#f3f4f6",text:"#374151"}})}}),_},fe=({formula:r,job:t,result:l})=>{const h=Tr(r,t);if(!h||h.length===0)return e.jsx("span",{children:l});const _=new Map(h.map(N=>[N.key,N])),b=()=>{const N=h.map(T=>T.key).sort((T,H)=>H.length-T.length),V=T=>T.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),w=new RegExp(`(${N.map(V).join("|")})`,"g");return r.split(w).map((T,H)=>{const K=_.get(T);if(K){const Se=typeof K.value=="number"?E(K.value):K.value;return e.jsx("span",{className:"inline-block px-1 py-0.5 rounded text-xs font-medium mx-0.5",style:{backgroundColor:K.color.bg,color:K.color.text},children:Se},H)}return e.jsx("span",{style:{color:"#374151"},children:T},H)})};return e.jsxs(Ft,{children:[e.jsx(Ot,{asChild:!0,children:e.jsx("span",{className:"cursor-help border-b border-dashed border-gray-400",children:l})}),e.jsx(St,{side:"top",style:{backgroundColor:"white",color:"#1f2937"},className:"border border-gray-200 shadow-lg max-w-md p-3",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-xs font-semibold",style:{color:"#4b5563"},children:"Formule berekening:"}),e.jsx("div",{className:"font-mono text-xs p-2 rounded border flex flex-wrap items-center",style:{backgroundColor:"#f3f4f6",borderColor:"#e5e7eb"},children:b()}),e.jsx("div",{className:"text-xs font-semibold mt-3 mb-1",style:{color:"#4b5563"},children:"Gebruikte waarden:"}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:h.map((N,V)=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded text-xs font-medium",style:{backgroundColor:N.color.bg,color:N.color.text},children:[e.jsxs("span",{style:{opacity:.7},children:[N.label,":"]}),e.jsx("span",{className:"font-bold",children:typeof N.value=="number"?E(N.value):N.value})]},V))}),e.jsxs("div",{className:"border-t pt-2 mt-2 flex items-center justify-between",style:{borderColor:"#e5e7eb"},children:[e.jsx("span",{className:"text-xs",style:{color:"#6b7280"},children:"Resultaat:"}),e.jsx("span",{className:"font-bold text-sm",style:{color:"#1f2937"},children:l})]})]})})]})},le=(r,t)=>{r?(Fe(r),he(r.name),Q(r.formula),pe(r.targetColumn)):(Fe(null),he(""),Q(""),pe(t)),ue(!0)},Fr=()=>{if(!(!se.trim()||!$.trim())){if(xe)Te(ee.map(r=>r.id===xe.id?{...r,name:se,formula:$,targetColumn:Oe}:r));else{const r={id:Date.now().toString(),name:se,formula:$,targetColumn:Oe};Te([...ee,r])}ue(!1),he(""),Q(""),pe(void 0),Fe(null)}},Or=r=>{Te(ee.filter(t=>t.id!==r))},Sr=Y.length>0?f($,Y[0]):"N/A";return e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Ur,{defaultValue:"werkorders",className:"w-full",children:[e.jsxs(qr,{className:"flex w-full whitespace-nowrap",children:[e.jsx(Re,{value:"werkorders",children:"Werkorders"}),e.jsx(Re,{value:"finished",children:"Finished"}),e.jsx(Re,{value:"parameters",children:"Parameters"})]}),e.jsx(De,{value:"werkorders",children:e.jsxs(je,{children:[e.jsx(be,{children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx(Ne,{children:"Werkorders"}),e.jsxs(F,{onClick:()=>B(j),children:[e.jsx(ye,{className:"w-4 h-4 mr-2"})," Werkorder"]})]})}),e.jsx(ve,{className:"space-y-4",children:v.map(r=>e.jsxs("div",{className:"border p-4 rounded-lg",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Order Nr"}),e.jsx(y,{value:`DT ${r.orderNr}`,readOnly:!0})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(C,{children:"Order"}),e.jsx(y,{value:r.orderName,readOnly:!0})]}),"                                                                                "]})}),e.jsxs(Ge,{children:[e.jsx(Me,{children:e.jsxs(W,{children:[e.jsx(g,{children:"Order Date"}),e.jsx(g,{children:"Versie/Katern"}),e.jsx(g,{style:{width:"100px"},children:"Pages"}),e.jsx(g,{style:{width:"100px"},children:"ex/omw"}),e.jsx(g,{style:{width:"100px"},children:"Oplage"}),e.jsx(g,{style:{width:"100px"},children:"Opstart"}),e.jsx(g,{style:{width:"100px"},children:"4/4"}),e.jsx(g,{style:{width:"100px"},children:"4/0"}),e.jsx(g,{style:{width:"100px"},children:"1/0"}),e.jsx(g,{style:{width:"100px"},children:"1/1"}),e.jsx(g,{style:{width:"100px"},children:"4/1"}),e.jsx(g,{children:"Max Bruto"}),e.jsx(g,{children:"Groen"}),e.jsx(g,{children:"Rood"}),e.jsx(g,{children:"Delta"}),e.jsx(g,{style:{width:"100px"},children:"Delta %"}),e.jsx(g,{children:"Actions"})]})}),e.jsx(Le,{children:r.katernen.map(t=>e.jsxs(W,{children:[e.jsx(p,{children:r.orderDate}),e.jsx(p,{children:e.jsx(y,{value:t.version})}),e.jsx(p,{children:e.jsx(y,{type:"number",value:t.pages})}),e.jsx(p,{children:e.jsx(y,{value:t.exOmw})}),e.jsx(p,{children:e.jsx(y,{type:"number",value:t.netRun})}),e.jsx(p,{children:e.jsx(oe,{checked:t.startup})}),e.jsx(p,{children:e.jsx(y,{type:"number",value:t.c4_4})}),e.jsx(p,{children:e.jsx(y,{type:"number",value:t.c4_0})}),e.jsx(p,{children:e.jsx(y,{type:"number",value:t.c1_0})}),e.jsx(p,{children:e.jsx(y,{type:"number",value:t.c1_1})}),e.jsx(p,{children:e.jsx(y,{type:"number",value:t.c4_1})}),e.jsx(p,{children:(()=>{const l=i("maxGross");return l?e.jsx(fe,{formula:l.formula,job:t,result:f(l.formula,t)}):E(t.maxGross)})()}),e.jsx(p,{children:e.jsx(y,{type:"number",value:t.green})}),e.jsx(p,{children:e.jsx(y,{type:"number",value:t.red})}),e.jsx(p,{children:(()=>{const l=i("delta_number");return E(l?f(l.formula,t):t.delta)})()}),e.jsx(p,{children:(()=>{const l=i("delta_percentage"),h=l?f(l.formula,t):E(t.deltaPercentage),_=typeof h=="string"?parseFloat(h.replace(/\./g,"").replace(",","."))*100:h*100,b=Math.round(_*100)/100;return b+"%"})()}),e.jsx(p,{children:e.jsx(F,{size:"sm",variant:"ghost",className:"hover:bg-red-100 text-red-500",children:e.jsx(Ee,{className:"w-4 h-4"})})})]},t.id))})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsxs(F,{onClick:()=>S(r.id),size:"sm",variant:"ghost",children:[e.jsx(ye,{className:"w-4 h-4 mr-1"})," Add Katern/Versie"]}),e.jsx(F,{onClick:()=>A(r),size:"sm",className:"w-48",children:"Order Opslaan"})]})]},r.id))})]})}),e.jsx(De,{value:"finished",children:e.jsxs(je,{children:[e.jsxs(be,{className:"flex flex-row items-center justify-between",children:[e.jsx(Ne,{children:"Finished Print Jobs"}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsxs(Ue,{value:ke,onValueChange:Nr,children:[e.jsx(qe,{className:"w-[130px]",children:e.jsx(Ye,{placeholder:"Filter by"})}),e.jsxs(Qe,{children:[e.jsx(U,{value:"all",children:"All Fields"}),e.jsx(U,{value:"orderNr",children:"Order Nr"}),e.jsx(U,{value:"orderName",children:"Order Name"}),e.jsx(U,{value:"date",children:"Date"})]})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Qr,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),e.jsx(y,{placeholder:"Search...",className:"pl-8 w-[200px]",value:Ce,onChange:r=>br(r.target.value)})]}),e.jsxs(F,{onClick:()=>{c(null),o(!0)},children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Add Finished Job"]})]})]}),e.jsx(ve,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ge,{className:"table-fixed w-full",children:[e.jsxs(Me,{children:[e.jsxs(W,{children:[e.jsx(g,{colSpan:6,className:"text-center bg-blue-100",style:{borderRight:"1px solid black"},children:"Data"}),e.jsx(g,{colSpan:6,className:"text-center bg-green-100",style:{borderTop:"1px solid black",borderRight:"1px solid black"},children:"Wissels"}),e.jsx(g,{colSpan:3,className:"text-center bg-yellow-100",style:{borderTop:"1px solid black",borderRight:"1px solid black"},children:"Berekening"}),e.jsx(g,{colSpan:2,className:"text-center bg-purple-100",style:{borderTop:"1px solid black",borderRight:"1px solid black"},children:"Prestatie"}),e.jsx(g,{className:"w-[100px]"})]}),e.jsxs(W,{children:[e.jsx(g,{onClick:()=>M("date"),style:{width:"83px"},className:"cursor-pointer hover:bg-gray-100 border-r",children:e.jsxs("div",{className:"flex items-center",children:["Date ",L("date")]})}),e.jsx(g,{onClick:()=>M("orderNr"),style:{width:"65px"},className:"cursor-pointer hover:bg-gray-100 border-r",children:e.jsxs("div",{className:"flex items-center",children:["Order nr ",L("orderNr")]})}),e.jsx(g,{onClick:()=>M("orderName"),className:"cursor-pointer hover:bg-gray-100 min-w-[150px] border-r",children:e.jsxs("div",{className:"flex items-center",children:["Order ",L("orderName")]})}),e.jsx(g,{onClick:()=>M("pages"),style:{width:"40px"},className:"cursor-pointer hover:bg-gray-100 text-right border-r",children:e.jsxs("div",{className:"flex items-center justify-end",children:["Blz ",L("pages")]})}),e.jsx(g,{onClick:()=>M("exOmw"),style:{width:"40px"},className:"cursor-pointer hover:bg-gray-100 text-right leading-3 border-r",children:e.jsxs("div",{className:"flex items-center justify-end h-full",children:["Ex/",e.jsx("br",{}),"Omw. ",L("exOmw")]})}),e.jsx(g,{onClick:()=>M("netRun"),style:{width:"80px",borderRight:"1px solid black"},className:"cursor-pointer hover:bg-gray-100 text-right",children:e.jsxs("div",{className:"flex items-center justify-end",children:["Oplage netto ",L("netRun")]})}),e.jsx(g,{onClick:()=>M("startup"),style:{width:"55px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-center",children:["Opstart ",L("startup")]})}),e.jsx(g,{onClick:()=>M("c4_4"),style:{width:"30px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["4/4 ",L("c4_4")]})}),e.jsx(g,{onClick:()=>M("c4_0"),style:{width:"30px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["4/0 ",L("c4_0")]})}),e.jsx(g,{onClick:()=>M("c1_0"),style:{width:"30px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["1/0 ",L("c1_0")]})}),e.jsx(g,{onClick:()=>M("c1_1"),style:{width:"30px"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["1/1 ",L("c1_1")]})}),e.jsx(g,{onClick:()=>M("c4_1"),style:{width:"30px",borderRight:"1px solid black"},className:"cursor-pointer hover:bg-gray-100 text-center bg-gray-50 border border-black",children:e.jsxs("div",{className:"flex items-center justify-center",children:["4/1 ",L("c4_1")]})}),e.jsx(g,{style:{width:"90px"},className:"text-center border-r",children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(F,{variant:"ghost",className:"h-auto p-0 font-bold hover:bg-transparent hover:text-blue-600 truncate max-w-[60px]",onClick:()=>le(i("maxGross"),"maxGross"),title:i("maxGross")?.name||"Max Bruto",children:i("maxGross")?.name||"Max Bruto"}),e.jsx("div",{onClick:()=>M("maxGross"),className:"cursor-pointer p-1 hover:bg-gray-200 rounded shrink-0",children:L("maxGross")})]})}),e.jsx(g,{style:{width:"90px"},className:"text-center border-r",children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(F,{variant:"ghost",className:"h-auto p-0 font-bold hover:bg-transparent hover:text-blue-600 truncate max-w-[60px]",onClick:()=>le(i("green"),"green"),title:i("green")?.name||"Groen",children:i("green")?.name||"Groen"}),e.jsx("div",{onClick:()=>M("green"),className:"cursor-pointer p-1 hover:bg-gray-200 rounded shrink-0",children:L("green")})]})}),e.jsx(g,{style:{width:"90px",borderRight:"1px solid black"},className:"text-center",children:e.jsxs("div",{className:"flex items-center gap-1 justify-center",children:[e.jsx(F,{variant:"ghost",className:"h-auto p-0 font-bold hover:bg-transparent hover:text-blue-600 truncate max-w-[60px]",onClick:()=>le(i("red"),"red"),title:i("red")?.name||"Rood",children:i("red")?.name||"Rood"}),e.jsx("div",{onClick:()=>M("red"),className:"cursor-pointer p-1 hover:bg-gray-200 rounded shrink-0",children:L("red")})]})}),e.jsx(g,{style:{width:"80px"},className:"text-center border-r",children:e.jsx("div",{className:"flex items-center gap-1 justify-center",children:e.jsx("span",{className:"font-bold",children:"Delta"})})}),e.jsx(g,{style:{width:"80px",borderRight:"1px solid black"},className:"text-center",children:e.jsx("div",{className:"flex items-center gap-1 justify-center",children:e.jsx("span",{className:"font-bold",children:"Delta %"})})}),e.jsx(g,{style:{width:"100px"},className:"text-center",children:e.jsx("div",{className:"flex items-center gap-1 justify-center",children:e.jsx("span",{className:"font-bold",children:"Acties"})})})]})]}),e.jsx(Le,{children:vr.map(r=>e.jsxs(W,{children:[e.jsx(p,{children:r.date}),e.jsxs(p,{children:["DT ",r.orderNr]}),e.jsx(p,{children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-medium",children:r.orderName}),e.jsxs("div",{className:"flex items-center text-xs text-gray-500 mt-0.5",children:[e.jsx("span",{className:"w-3 h-3 border-l border-b border-gray-300 mr-1 rounded-bl-sm inline-block"}),r.version]})]})}),e.jsxs(p,{className:"text-right",children:[E(r.pages)," blz"]}),e.jsx(p,{className:"text-right",children:r.exOmw}),e.jsx(p,{className:"text-right",style:{borderRight:"1px solid black"},children:E(r.netRun)}),e.jsx(p,{className:"bg-gray-50",children:e.jsx("div",{className:"flex justify-center",children:r.startup?e.jsx(Yr,{className:"w-4 h-4 text-green-600"}):e.jsx("span",{className:"text-gray-300",children:"-"})})}),e.jsx(p,{className:"text-right bg-gray-50",children:E(r.c4_4)}),e.jsx(p,{className:"text-right bg-gray-50",children:E(r.c4_0)}),e.jsx(p,{className:"text-right bg-gray-50",children:E(r.c1_0)}),e.jsx(p,{className:"text-right bg-gray-50",children:E(r.c1_1)}),e.jsx(p,{className:"text-right bg-gray-50",style:{borderRight:"1px solid black"},children:E(r.c4_1)}),e.jsx(p,{className:"p-0 text-center",children:(()=>{const t=i("maxGross");return t?e.jsx(fe,{formula:t.formula,job:r,result:f(t.formula,r)}):E(r.maxGross)})()}),e.jsx(p,{className:"p-0 text-center",children:(()=>{const t=i("green");return t?e.jsx(fe,{formula:t.formula,job:r,result:f(t.formula,r)}):E(r.green)})()}),e.jsx(p,{className:"p-0 text-center",style:{borderRight:"1px solid black"},children:(()=>{const t=i("red");return t?e.jsx(fe,{formula:t.formula,job:r,result:f(t.formula,r)}):E(r.red)})()}),e.jsx(p,{className:"p-0 text-center",children:(()=>{const t=i("delta_number");return E(t?f(t.formula,r):r.delta_number)})()}),e.jsx(p,{className:"p-0 text-center",style:{borderRight:"1px solid black"},children:(()=>{const t=i("delta_percentage"),l=t?f(t.formula,r):E(r.delta_percentage),h=typeof l=="string"?parseFloat(l.replace(/\./g,"").replace(",","."))*100:l*100,_=Math.round(h*100)/100;return _+"%"})()}),e.jsx(p,{children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{size:"sm",variant:"ghost",className:"hover:bg-blue-100 text-blue-600",onClick:()=>wr(r),children:e.jsx(Ze,{className:"w-4 h-4"})}),e.jsx(F,{size:"sm",variant:"ghost",className:"hover:bg-red-100 text-red-500",onClick:()=>Cr(r.id),children:e.jsx(Ee,{className:"w-4 h-4"})})]})})]},r.id))})]})})})]})}),e.jsx(De,{value:"parameters",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs(je,{children:[e.jsx(be,{children:e.jsx(Ne,{children:"Parameters"})}),e.jsxs(ve,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs(Ge,{children:[e.jsx(Me,{children:e.jsxs(W,{children:[e.jsx(g,{className:"w-[200px]",children:"Parameter"}),e.jsx(g,{className:"w-[50px] text-center",children:"Link"}),a.map(r=>e.jsx(g,{className:"text-center min-w-[120px]",children:r},r))]})}),e.jsxs(Le,{children:[e.jsxs(W,{children:[e.jsx(p,{className:"font-medium",children:"Marge"}),e.jsx(p,{className:"text-center",children:e.jsx(oe,{checked:J.margePercentage,onCheckedChange:()=>Z("margePercentage")})}),a.map(r=>e.jsx(p,{children:e.jsx("div",{className:"flex gap-2",children:e.jsx(y,{type:"text",placeholder:"%",className:"h-8",value:D[r]?.margePercentage||"",onChange:t=>X(r,"margePercentage",t.target.value)})})},r))]}),e.jsxs(W,{children:[e.jsx(p,{className:"font-medium",children:"Opstart"}),e.jsx(p,{className:"text-center",children:e.jsx(oe,{checked:J.opstart,onCheckedChange:()=>Z("opstart")})}),a.map(r=>e.jsx(p,{className:"text-center",children:e.jsx(y,{type:"number",className:"h-8",value:D[r]?.opstart||0,onChange:t=>X(r,"opstart",Number(t.target.value))})},r))]}),[{id:"param_4_4",label:"4/4"},{id:"param_4_0",label:"4/0"},{id:"param_1_0",label:"1/0"},{id:"param_1_1",label:"1/1"},{id:"param_4_1",label:"4/1"}].map(r=>e.jsxs(W,{children:[e.jsx(p,{className:"font-medium",children:r.label}),e.jsx(p,{className:"text-center",children:e.jsx(oe,{checked:J[r.id],onCheckedChange:()=>Z(r.id)})}),a.map(t=>e.jsx(p,{children:e.jsx(y,{type:"number",className:"h-8",value:D[t]?.[r.id]||0,onChange:l=>X(t,r.id,Number(l.target.value))})},t))]},r.id))]})]})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx(F,{children:"Save Changes"})})]})]}),e.jsxs(je,{children:[e.jsxs(be,{className:"flex flex-row items-center justify-between",children:[e.jsx(Ne,{children:"Calculated Fields"}),e.jsxs(F,{onClick:()=>le(),className:"gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Add Formula"]})]}),e.jsx(ve,{children:ee.length===0?e.jsx("p",{className:"text-gray-500 text-center py-8",children:'No calculated fields yet. Click "Add Formula" to create one.'}):e.jsx("div",{className:"space-y-2",children:ee.map(r=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium",children:r.name}),e.jsx("div",{className:"text-sm text-gray-600 font-mono",children:r.formula}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Preview: ",f(r.formula,Y[0])]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>le(r),children:e.jsx(Ze,{className:"w-4 h-4"})}),e.jsx(F,{variant:"ghost",size:"sm",onClick:()=>Or(r.id),children:e.jsx(Ee,{className:"w-4 h-4 text-red-500"})})]})]},r.id))})})]})]})})]}),e.jsx(Pt,{open:n,onOpenChange:o,onSubmit:yr,editJob:m}),e.jsx(sr,{open:kr,onOpenChange:ue,children:e.jsxs(ar,{className:"max-w-2xl",children:[e.jsxs(nr,{children:[e.jsxs(lr,{className:"flex items-center gap-2",children:[e.jsx(st,{className:"w-5 h-5"}),xe?"Edit Formula":"Create Calculated Field"]}),e.jsx(cr,{children:"Build a formula by clicking on fields, operators, and numbers below."})]}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{htmlFor:"formula-name",children:"Field Name *"}),e.jsx(y,{id:"formula-name",placeholder:"e.g., Total Cost",value:se,onChange:r=>he(r.target.value)})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{children:"Target Column (Optional)"}),e.jsxs(Ue,{value:Oe||"none",onValueChange:r=>pe(r==="none"?void 0:r),children:[e.jsx(qe,{children:e.jsx(Ye,{placeholder:"Select a column to display this formula"})}),e.jsxs(Qe,{children:[e.jsx(U,{value:"none",children:"None (Reference only)"}),e.jsx(U,{value:"maxGross",children:"Max Bruto"}),e.jsx(U,{value:"delta_number",children:"Delta Number"}),e.jsx(U,{value:"delta_percentage",children:"Delta Percentage"})]})]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(C,{children:"Formula"}),e.jsx(y,{value:$,onChange:r=>Q(r.target.value),placeholder:"Type or click fields below to build formula...",className:"font-mono"}),e.jsx("div",{className:"p-3 border rounded-md bg-gray-50 min-h-[60px] flex flex-wrap gap-2 items-center",children:$?$.split(" ").filter(r=>r).map((r,t)=>{const l=ae.some(b=>b.key===r)||ne.some(b=>b.key===r),h=ze.includes(r),_=!isNaN(Number(r))&&r!=="";if(l){const b=ae.find(N=>N.key===r)||ne.find(N=>N.key===r);return e.jsx(Ae,{variant:"outline",className:"bg-blue-50 border-blue-200",children:b?.label||r},t)}else return h?e.jsx("span",{className:"px-2 py-1 bg-gray-200 rounded font-mono text-sm",children:r},t):_?e.jsx("span",{className:"px-2 py-1 bg-green-50 border border-green-200 rounded font-mono text-sm",children:r},t):e.jsx("span",{className:"font-mono text-sm",children:r},t)}):e.jsx("span",{className:"text-gray-400 text-sm",children:"Formula will appear here..."})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(F,{variant:"outline",size:"sm",onClick:()=>Q(""),children:"Clear"}),e.jsx(F,{variant:"outline",size:"sm",onClick:()=>Q(r=>r.trim().split(" ").slice(0,-1).join(" ")),children:"Remove Last"})]})]}),e.jsxs("div",{className:"grid gap-3",children:[e.jsxs("div",{children:[e.jsx(C,{className:"text-xs text-gray-600",children:"Finished Job Fields"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:ae.map(r=>e.jsx(Ae,{variant:"outline",className:"cursor-pointer hover:bg-blue-100",onClick:()=>ge(r.key),children:r.label},r.key))})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-xs text-gray-600",children:"Parameters"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:ne.map(r=>e.jsx(Ae,{variant:"outline",className:"cursor-pointer hover:bg-green-100",onClick:()=>ge(r.key),children:r.label},r.key))})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-xs text-gray-600",children:"Operators"}),e.jsx("div",{className:"flex gap-2 mt-2",children:ze.map(r=>e.jsx(F,{variant:"outline",size:"sm",onClick:()=>ge(r),className:"w-10",children:r},r))})]}),e.jsxs("div",{children:[e.jsx(C,{className:"text-xs text-gray-600",children:"Number"}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx(y,{type:"number",placeholder:"Enter number",className:"w-32",onKeyDown:r=>{r.key==="Enter"&&(ge(r.target.value),r.target.value="")}}),e.jsx("span",{className:"text-xs text-gray-500 self-center",children:"Press Enter to add"})]})]})]}),e.jsxs("div",{className:"p-3 border rounded-md bg-blue-50",children:[e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Preview Result"}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 mt-1",children:Sr}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Using first job data with sample parameter values"})]})]}),e.jsxs(or,{children:[e.jsx(F,{variant:"outline",onClick:()=>ue(!1),children:"Cancel"}),e.jsx(F,{onClick:Fr,disabled:!se.trim()||!$.trim(),children:xe?"Update Formula":"Save Formula"})]})]})})]})}export{It as Drukwerken};
